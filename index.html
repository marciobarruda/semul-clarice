<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Prontu√°rio Eletr√¥nico ‚Ä¢ CRCL</title>
    <link
      rel="icon"
      href="https://statics.recife.pe.gov.br/images/dynamics/conecta/icons/favicon.png?w=32&h=32&fit=fill&border=2,transparent,shrink"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" rel="stylesheet" />
    <style>
      :root {
        --brand-primary: #0053a4;
        --brand-secondary: #003a73;
        --brand-highlight: #00a3ff;
        --surface: #f4f7fb;
        --surface-strong: #ffffff;
        --border-color: #d0d7e2;
        --text-strong: #1b263b;
        --text-muted: #5b6c8c;
      }

      *, *::before, *::after {
        box-sizing: border-box;
      }

      body {
        font-family: "Public Sans", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        background: var(--surface);
        color: var(--text-strong);
        min-height: 100vh;
      }

      header.site-header {
        background: url("https://statics.recife.pe.gov.br/images/dynamics/automacao/header.png?w=3000")
          center/cover no-repeat;
        color: #ffffff;
        padding: 3.5rem 0 2.75rem;
      }

      header .lead {
        color: rgba(255, 255, 255, 0.82);
        max-width: 100%;
        font-size: 1rem;
        line-height: 1.65;
        text-align: justify;
      }

      .badge-open {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.95rem;
        font-weight: 600;
        padding: 0.45rem 0.9rem;
        border-radius: 999px;
        background-color: rgba(255, 255, 255, 0.14);
      }

      .user-greeting {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 1.05rem;
        font-weight: 600;
        margin-bottom: 2rem;
        padding: 1rem 1.5rem;
        border-radius: 1rem;
        background: linear-gradient(135deg, rgba(0, 83, 164, 0.09), rgba(0, 163, 255, 0.12));
        color: var(--text-strong);
        box-shadow: 0 10px 30px rgba(0, 45, 98, 0.08);
      }

      .user-greeting::before {
        content: "üëã";
        font-size: 1.4rem;
      }

      .minhas-inscricoes-grid {
        margin-top: 1rem;
      }

      .minhas-inscricao-card {
        cursor: pointer;
        transition: transform 0.18s ease, box-shadow 0.18s ease;
        border: 1px solid rgba(0, 83, 164, 0.12);
        border-radius: 4px;
      }

      .minhas-inscricao-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 12px 30px rgba(0, 45, 98, 0.12);
      }

      .minhas-inscricao-card.is-loading {
        pointer-events: none;
        opacity: 0.7;
      }

      .minhas-inscricoes-placeholder {
        padding: 1.25rem;
        border-radius: 4px;
        background: rgba(0, 83, 164, 0.05);
        border: 1px dashed rgba(0, 83, 164, 0.2);
        color: var(--text-muted);
      }

      .resumo-inscricao-list dt {
        font-size: 0.75rem;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        color: var(--text-muted);
      }

      .resumo-inscricao-list dd {
        font-weight: 600;
        color: var(--text-strong);
      }

      .section-title {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
        font-weight: 600;
      }

      .section-title .icon-wrapper {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 2.5rem;
        height: 2.5rem;
        border-radius: 0.75rem;
        background: rgba(0, 83, 164, 0.12);
        color: var(--brand-primary);
        font-size: 1.25rem;
      }

      .kpi-card {
        border-radius: 1rem;
        background: var(--surface-strong);
        border: 1px solid rgba(0, 0, 0, 0.04);
        box-shadow: 0 12px 30px rgba(24, 64, 120, 0.08);
        padding: 1.5rem;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .kpi-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 18px 40px rgba(24, 64, 120, 0.12);
      }

      .kpi-card .icon {
        width: 3rem;
        height: 3rem;
        border-radius: 0.85rem;
        background: rgba(0, 83, 164, 0.12);
        color: var(--brand-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        margin-bottom: 1rem;
      }

      .kpi-card .value {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.25rem;
      }

      .card-section {
        border: 1px solid var(--border-color);
        border-radius: 1rem;
        background: var(--surface-strong);
        box-shadow: 0 12px 30px rgba(24, 64, 120, 0.08);
        padding: 1.75rem;
        height: 100%;
        scroll-margin-top: 6.5rem;
      }

      .card-section + .card-section {
        margin-top: 1.5rem;
      }

      .form-section-nav {
        position: sticky;
        top: 5.5rem;
        z-index: 1030;
        background: rgba(244, 247, 251, 0.94);
        border: 1px solid rgba(0, 83, 164, 0.15);
        border-radius: 1rem;
        padding: 1rem 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 8px 24px rgba(0, 45, 98, 0.12);
        backdrop-filter: blur(6px);
      }

      .form-section-nav .nav-label {
        font-size: 0.75rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: var(--text-muted);
        margin-bottom: 0.5rem;
        display: block;
      }

      .section-nav-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .section-nav-link {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        padding: 0.45rem 0.95rem;
        border-radius: 999px;
        text-decoration: none;
        font-weight: 500;
        font-size: 0.9rem;
        background: rgba(0, 83, 164, 0.08);
        color: var(--brand-primary);
        transition: background-color 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
      }

      .section-nav-link .bi {
        font-size: 1rem;
      }

      .section-nav-link:hover,
      .section-nav-link:focus {
        background: rgba(0, 83, 164, 0.18);
        color: var(--brand-secondary);
        box-shadow: 0 6px 16px rgba(0, 45, 98, 0.15);
      }

      .section-nav-link.active {
        background: var(--brand-primary);
        color: #ffffff;
        box-shadow: 0 8px 18px rgba(0, 45, 98, 0.2);
      }

      @media (max-width: 576px) {
        .form-section-nav {
          top: 4.25rem;
          padding: 0.75rem 1rem;
        }

        .section-nav-list {
          gap: 0.75rem 0.5rem;
        }

        .section-nav-link {
          flex: 1 1 calc(50% - 0.5rem);
          justify-content: center;
        }
      }

      .subsection-card {
        border: 1px dashed rgba(0, 83, 164, 0.25);
        border-radius: 0.85rem;
        background: rgba(0, 83, 164, 0.04);
        padding: 1.25rem;
      }

      .subsection-heading {
        font-size: 0.9rem;
        font-weight: 700;
        text-transform: uppercase;
        color: var(--brand-primary);
        letter-spacing: 0.05em;
        margin-bottom: 1rem;
      }

      .section-header {
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 0.75rem;
        margin-bottom: 1.25rem;
      }

      .required::after {
        content: "*";
        color: #d32f2f;
        margin-left: 0.25rem;
      }

      .legend-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        font-size: 0.85rem;
        color: var(--brand-secondary);
        background: rgba(0, 83, 164, 0.12);
        padding: 0.35rem 0.75rem;
        border-radius: 999px;
      }

      .tooltip-inner {
        text-align: left;
      }

      .btn-outline-primary:focus-visible,
      .form-control:focus,
      .form-select:focus,
      .form-check-input:focus {
        box-shadow: 0 0 0 0.25rem rgba(0, 83, 164, 0.25);
        border-color: var(--brand-highlight);
      }

      .border-dashed {
        border-style: dashed !important;
      }

      .banner-card {
        background: linear-gradient(135deg, rgba(120, 58, 163, 0.85), rgba(235, 129, 162, 0.9)),
          url("https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=800&q=80") center/cover;
        border-radius: 1rem;
        color: #fff;
        padding: 2rem;
        min-height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        box-shadow: 0 18px 45px rgba(94, 33, 123, 0.28);
      }

      .banner-card .btn {
        align-self: flex-start;
      }

      .timeline-item {
        position: relative;
        padding-left: 1.75rem;
      }

      .timeline-item::before {
        content: "";
        position: absolute;
        left: 0.5rem;
        top: 0.35rem;
        width: 0.5rem;
        height: 0.5rem;
        background: var(--brand-highlight);
        border-radius: 50%;
      }

      .timeline-item + .timeline-item {
        margin-top: 1rem;
      }

      footer {
        color: var(--text-muted);
        padding: 2.5rem 0 2rem;
        font-size: 0.9rem;
      }

      .tab-content {
        margin-top: 2rem;
      }

      .nav-tabs .nav-link.active {
        background: var(--surface-strong);
        border-color: var(--border-color) var(--border-color) var(--surface-strong);
        color: var(--brand-primary);
        font-weight: 600;
      }

      .nav-tabs .nav-link {
        color: var(--text-muted);
        font-weight: 500;
      }

      .form-section-title {
        font-weight: 600;
        font-size: 1.1rem;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        scroll-margin-top: 6.5rem;
      }

      .form-section-title .bi {
        color: var(--brand-primary);
      }

      .floating-toolbar {
        position: sticky;
        top: 1rem;
        z-index: 1020;
      }

      .toast-header {
        background: var(--brand-primary);
        color: #fff;
      }

      @media (max-width: 992px) {
        header.site-header {
          padding: 2.5rem 0 2rem;
        }

        .badge-open {
          width: 100%;
          justify-content: center;
        }

        .banner-card {
          margin-top: 1.5rem;
        }

        .floating-toolbar {
          position: static;
          margin-top: 1.5rem;
        }
      }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/imask@7.1.3/dist/imask.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/just-validate@4.3.0/dist/just-validate.production.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.11/dayjs.min.js" defer></script>
  </head>
  <body>
    <div class="toast-container position-fixed top-0 end-0 p-3" aria-live="polite" aria-atomic="true">
      <div class="toast align-items-center" id="successToast" role="status" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
          <i class="bi bi-check-circle-fill me-2"></i>
          <strong class="me-auto">Registro salvo</strong>
          <button type="button" class="btn-close btn-close-white ms-2 mb-1" data-bs-dismiss="toast" aria-label="Fechar"></button>
        </div>
        <div class="toast-body">Dados enviados com sucesso para a Rede de Enfrentamento.</div>
      </div>
    </div>

    <header class="site-header">
      <div class="container">
        <div class="d-flex flex-wrap align-items-center justify-content-between gap-3">
          <div class="d-flex align-items-center gap-3">
            <img
              src="https://statics.recife.pe.gov.br/images/dynamics/conecta/logo_prefeitura_recife.png?w=280"
              alt="Prefeitura do Recife"
              class="img-fluid"
              style="max-width: 180px"
            />
            <div>
              <span class="badge-open text-uppercase">Secretaria da Mulher</span>
              <h1 class="h3 mb-1">Rede de Enfrentamento √† Viol√™ncia Contra a Mulher</h1>
              <p class="lead mb-0">Centro de Refer√™ncia Clarice Lispector ‚Äî acolhimento, prote√ß√£o e a√ß√µes integradas para as mulheres do Recife.</p>
            </div>
          </div>
          <div class="d-flex align-items-center gap-2 text-white">
            <button class="btn btn-outline-light btn-sm" type="button" aria-label="Central de notifica√ß√µes">
              <i class="bi bi-bell-fill"></i>
            </button>
            <button class="btn btn-outline-light btn-sm" type="button" aria-label="Acesso r√°pido ao perfil">
              <i class="bi bi-person-circle"></i>
            </button>
          </div>
        </div>
      </div>
    </header>

    <main>
      <div class="container py-5">
        <div class="user-greeting" role="status">Bem-vinda, Ana Paula ‚Äî acompanhe os casos e encaminhamentos da rede de prote√ß√£o.</div>

        <div class="d-flex flex-column flex-lg-row gap-3 mb-4 align-items-lg-center">
          <ul class="nav nav-tabs" id="portalTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">
                <i class="bi bi-house-door me-1"></i>
                Home
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="prontuarios-tab" data-bs-toggle="tab" data-bs-target="#prontuarios" type="button" role="tab" aria-controls="prontuarios" aria-selected="false">
                <i class="bi bi-folder2-open me-1"></i>
                Prontu√°rios
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="bi-tab" data-bs-toggle="tab" data-bs-target="#bi" type="button" role="tab" aria-controls="bi" aria-selected="false">
                <i class="bi bi-graph-up-arrow me-1"></i>
                BI ‚Äî Dados Gerais
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="form-tab" data-bs-toggle="tab" data-bs-target="#formulario" type="button" role="tab" aria-controls="formulario" aria-selected="false">
                <i class="bi bi-journal-medical me-1"></i>
                Novo Registro
              </button>
            </li>
          </ul>
          <div class="ms-lg-auto floating-toolbar d-flex gap-2">
            <button class="btn btn-primary" type="button" id="openFormBtn">
              <i class="bi bi-plus-circle me-2"></i>
              Novo Registro / Formul√°rio
            </button>
            <button class="btn btn-outline-primary" type="button">
              <i class="bi bi-cloud-arrow-down me-2"></i>
              Exportar BI
            </button>
          </div>
        </div>

        <div class="tab-content" id="portalTabsContent">
          <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
            <div class="row g-4 mb-4">
              <div class="col-12 col-md-6 col-xl-3">
                <div class="kpi-card h-100" role="group" aria-label="Total de prontu√°rios cadastrados">
                  <div class="icon"><i class="bi bi-people-fill"></i></div>
                  <div class="value" aria-live="polite">1.482</div>
                  <p class="mb-0 text-muted">Prontu√°rios cadastrados</p>
                  <small class="text-success fw-semibold"><i class="bi bi-arrow-up-right me-1"></i>+8% vs. m√™s anterior</small>
                </div>
              </div>
              <div class="col-12 col-md-6 col-xl-3">
                <div class="kpi-card h-100" role="group" aria-label="Atendimentos ativos">
                  <div class="icon"><i class="bi bi-activity"></i></div>
                  <div class="value">327</div>
                  <p class="mb-0 text-muted">Atendimentos ativos</p>
                  <small class="text-success fw-semibold"><i class="bi bi-lightning-charge-fill me-1"></i>Ativa√ß√µes em tempo real</small>
                </div>
              </div>
              <div class="col-12 col-md-6 col-xl-3">
                <div class="kpi-card h-100" role="group" aria-label="Medidas protetivas">
                  <div class="icon"><i class="bi bi-shield-lock"></i></div>
                  <div class="value">214</div>
                  <p class="mb-0 text-muted">Medidas protetivas acompanhadas</p>
                  <small class="text-muted">34 aguardando despacho</small>
                </div>
              </div>
              <div class="col-12 col-md-6 col-xl-3">
                <div class="kpi-card h-100" role="group" aria-label="Encaminhamentos">
                  <div class="icon"><i class="bi bi-signpost-2"></i></div>
                  <div class="value">96</div>
                  <p class="mb-0 text-muted">Encaminhamentos realizados</p>
                  <small class="text-danger fw-semibold"><i class="bi bi-arrow-down-right me-1"></i>-3% vs. √∫ltimo m√™s</small>
                </div>
              </div>
            </div>

            <div class="row g-4 align-items-stretch">
              <div class="col-12 col-xl-8 d-flex flex-column gap-4">
                <section class="card-section" aria-labelledby="busca-casos">
                  <div class="section-header d-flex justify-content-between align-items-center">
                    <h2 class="h5 mb-0" id="busca-casos">Busca e filtros inteligentes</h2>
                    <span class="legend-badge"><i class="bi bi-search me-1"></i>Pesquisa avan√ßada</span>
                  </div>
                  <form class="row g-3" role="search" aria-label="Buscar prontu√°rios">
                    <div class="col-12 col-md-4">
                      <label for="buscaNome" class="form-label">Nome da usu√°ria</label>
                      <input type="text" class="form-control" id="buscaNome" placeholder="Maria Silva" />
                    </div>
                    <div class="col-12 col-md-4">
                      <label for="buscaDocumento" class="form-label">CPF</label>
                      <input type="text" class="form-control" id="buscaDocumento" placeholder="000.000.000-00" />
                    </div>
                    <div class="col-12 col-md-4">
                      <label for="buscaSituacao" class="form-label">Situa√ß√£o</label>
                      <select class="form-select" id="buscaSituacao">
                        <option value="">Todas</option>
                        <option>Ativo</option>
                        <option>Em an√°lise</option>
                        <option>Encerrado</option>
                      </select>
                    </div>
                    <div class="col-12 col-md-4">
                      <label for="buscaTipificacao" class="form-label">Tipifica√ß√£o</label>
                      <select class="form-select" id="buscaTipificacao">
                        <option value="">Todas</option>
                        <option>Viol√™ncia f√≠sica</option>
                        <option>Viol√™ncia psicol√≥gica</option>
                        <option>Viol√™ncia sexual</option>
                        <option>Viol√™ncia moral</option>
                        <option>Viol√™ncia patrimonial</option>
                      </select>
                    </div>
                    <div class="col-12 col-md-4">
                      <label for="buscaPeriodo" class="form-label">Per√≠odo</label>
                      <input type="month" class="form-control" id="buscaPeriodo" />
                    </div>
                    <div class="col-12 col-md-4">
                      <label for="buscaEncaminhamento" class="form-label">Encaminhamento</label>
                      <select class="form-select" id="buscaEncaminhamento">
                        <option value="">Todos</option>
                        <option>Delegacia da Mulher</option>
                        <option>CREAS</option>
                        <option>Sa√∫de</option>
                        <option>Assist√™ncia social</option>
                      </select>
                    </div>
                    <div class="col-12 d-flex justify-content-end gap-2">
                      <button class="btn btn-outline-secondary" type="reset">Limpar</button>
                      <button class="btn btn-primary" type="button">Aplicar filtros</button>
                    </div>
                  </form>
          <div class="modal fade" id="familiaModal" tabindex="-1" aria-labelledby="familiaModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-scrollable">
              <div class="modal-content">
                <div class="modal-header">
                  <h2 class="modal-title fs-5" id="familiaModalLabel">Adicionar membro da fam√≠lia</h2>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
                </div>
                <form id="familiaModalForm">
                  <div class="modal-body">
                    <div class="row g-3">
                      <div class="col-12 col-md-6">
                        <label for="familiaNome" class="form-label required">Nome completo</label>
                        <input type="text" class="form-control" id="familiaNome" name="familiaNome" required />
                      </div>
                      <div class="col-12 col-md-6">
                        <label for="familiaParentesco" class="form-label required">Parentesco</label>
                        <select id="familiaParentesco" name="familiaParentesco" class="form-select" required>
                          <option value="">Selecione</option>
                          <option>C√¥njuge/companheiro(a)</option>
                          <option>Filho(a)</option>
                          <option>Pai</option>
                          <option>M√£e</option>
                          <option>Irm√£o(√£)</option>
                          <option>Outro</option>
                        </select>
                      </div>
                      <div class="col-12 col-md-3">
                        <label for="familiaIdadeAnos" class="form-label required">Idade (anos)</label>
                        <input type="number" min="0" class="form-control" id="familiaIdadeAnos" name="familiaIdadeAnos" required />
                      </div>
                      <div class="col-12 col-md-3">
                        <label for="familiaIdadeMeses" class="form-label">Meses</label>
                        <input type="number" min="0" max="11" class="form-control" id="familiaIdadeMeses" name="familiaIdadeMeses" />
                      </div>
                      <div class="col-12 col-md-6">
                        <label for="familiaEscolaridade" class="form-label">Escolaridade</label>
                        <select id="familiaEscolaridade" name="familiaEscolaridade" class="form-select">
                          <option value="">Selecione</option>
                          <option>Educa√ß√£o infantil</option>
                          <option>Ensino fundamental</option>
                          <option>Ensino m√©dio</option>
                          <option>Ensino t√©cnico</option>
                          <option>Ensino superior</option>
                          <option>P√≥s-gradua√ß√£o</option>
                        </select>
                      </div>
                      <div class="col-12 col-md-6">
                        <label for="familiaRedeEnsino" class="form-label">Rede de ensino</label>
                        <select id="familiaRedeEnsino" name="familiaRedeEnsino" class="form-select">
                          <option value="">Selecione</option>
                          <option>P√∫blica</option>
                          <option>Privada</option>
                          <option>N√£o frequenta</option>
                        </select>
                      </div>
                      <div class="col-12">
                        <label for="familiaProfissao" class="form-label">Profiss√£o/Ocupa√ß√£o</label>
                        <input type="text" class="form-control" id="familiaProfissao" name="familiaProfissao" />
                      </div>
                    </div>
                    <hr class="my-4" />
                    <div class="row g-3">
                      <div class="col-12">
                        <span class="form-label d-block">Pessoa com defici√™ncia</span>
                      </div>
                      <div class="col-12 col-md-6">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="familiaDeficienciaMotora" id="familiaDeficienciaMotoraNao" value="N√£o" checked />
                          <label class="form-check-label" for="familiaDeficienciaMotoraNao">Sem defici√™ncia motora</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="familiaDeficienciaMotora" id="familiaDeficienciaMotoraSim" value="Sim" />
                          <label class="form-check-label" for="familiaDeficienciaMotoraSim">Motora</label>
                        </div>
                      </div>
                      <div class="col-12 col-md-6">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="familiaDeficienciaAuditiva" id="familiaDeficienciaAuditivaNao" value="N√£o" checked />
                          <label class="form-check-label" for="familiaDeficienciaAuditivaNao">Sem defici√™ncia auditiva</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="familiaDeficienciaAuditiva" id="familiaDeficienciaAuditivaSim" value="Sim" />
                          <label class="form-check-label" for="familiaDeficienciaAuditivaSim">Auditiva</label>
                        </div>
                      </div>
                      <div class="col-12 col-md-6">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="familiaDeficienciaVisual" id="familiaDeficienciaVisualNao" value="N√£o" checked />
                          <label class="form-check-label" for="familiaDeficienciaVisualNao">Sem defici√™ncia visual</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="familiaDeficienciaVisual" id="familiaDeficienciaVisualSim" value="Sim" />
                          <label class="form-check-label" for="familiaDeficienciaVisualSim">Visual</label>
                        </div>
                      </div>
                      <div class="col-12 col-md-6">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="familiaDeficienciaMental" id="familiaDeficienciaMentalNao" value="N√£o" checked />
                          <label class="form-check-label" for="familiaDeficienciaMentalNao">Sem defici√™ncia mental</label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="familiaDeficienciaMental" id="familiaDeficienciaMentalSim" value="Sim" />
                          <label class="form-check-label" for="familiaDeficienciaMentalSim">Intelectual</label>
                        </div>
                      </div>
                      <div class="col-12 col-md-6">
                        <label for="familiaBeneficio" class="form-label">Benef√≠cio de programa social</label>
                        <select id="familiaBeneficio" name="familiaBeneficio" class="form-select">
                          <option value="">Selecione</option>
                          <option>Bolsa Fam√≠lia</option>
                          <option>Aux√≠lio municipal</option>
                          <option>BPC</option>
                          <option>Outro</option>
                          <option>N√£o recebe</option>
                        </select>
                      </div>
                      <div class="col-12 col-md-6">
                        <span class="form-label d-block">Benefici√°rio(a) BPC?</span>
                        <div class="d-flex gap-3">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="familiaBpc" id="familiaBpcNao" value="N√£o" checked />
                            <label class="form-check-label" for="familiaBpcNao">N√£o</label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="familiaBpc" id="familiaBpcSim" value="Sim" />
                            <label class="form-check-label" for="familiaBpcSim">Sim</label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
                </section>

                <section class="card-section" aria-labelledby="minhas-tarefas">
                  <div class="section-header d-flex justify-content-between align-items-center">
                    <h2 class="h5 mb-0" id="minhas-tarefas">Minhas tarefas</h2>
                    <a href="#" class="btn btn-sm btn-outline-primary">Ver agenda</a>
                  </div>
                  <div class="row g-4">
                    <div class="col-12 col-lg-6">
                      <div class="border rounded-3 p-3 h-100">
                        <h3 class="h6 d-flex align-items-center gap-2 mb-1">
                          <i class="bi bi-calendar-check text-primary"></i>
                          Retorno psicossocial
                        </h3>
                        <p class="mb-2 text-muted">Agendado para 14/05 √†s 10h ‚Äî Unidade Casa Amarela.</p>
                        <span class="badge bg-primary-subtle text-primary">Prontu√°rio #2023-541</span>
                      </div>
                    </div>
                    <div class="col-12 col-lg-6">
                      <div class="border rounded-3 p-3 h-100">
                        <h3 class="h6 d-flex align-items-center gap-2 mb-1">
                          <i class="bi bi-chat-square-text text-primary"></i>
                          Atualizar medidas protetivas
                        </h3>
                        <p class="mb-2 text-muted">Acompanhar despacho da 1¬™ Vara ‚Äî prazo em 2 dias.</p>
                        <span class="badge bg-warning-subtle text-warning">Urgente</span>
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="border rounded-3 p-3">
                        <h3 class="h6 d-flex align-items-center gap-2 mb-2">
                          <i class="bi bi-people text-primary"></i>
                          Encontros da rede ‚Äî Maio
                        </h3>
                        <div class="timeline-item">
                          <strong>15/05</strong> ‚Äî Reuni√£o com Delegacia Especializada no audit√≥rio central.
                        </div>
                        <div class="timeline-item">
                          <strong>20/05</strong> ‚Äî Oficina de atualiza√ß√£o de fluxos com CREAS e Sa√∫de.
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
              </div>
              <div class="col-12 col-xl-4">
                <aside class="banner-card" aria-label="Campanha SoMar">
                  <div>
                    <span class="badge bg-light text-dark mb-3">Campanha Clarice Lispector</span>
                    <h2 class="h4">Projeto SoMar ‚Äî Fortalecendo v√≠nculos e autonomia das mulheres</h2>
                    <p class="mb-0">Conhe√ßa a√ß√µes de capacita√ß√£o, acolhimento psicossocial e articula√ß√£o comunit√°ria realizadas na rede.</p>
                  </div>
                  <a class="btn btn-light btn-lg mt-4" href="#" role="button">
                    <i class="bi bi-arrow-up-right-circle me-2"></i>
                    Acessar materiais
                  </a>
                </aside>
              </div>
            </div>
          </div>

          <div class="tab-pane fade" id="prontuarios" role="tabpanel" aria-labelledby="prontuarios-tab">
            <section class="card-section mb-4" aria-labelledby="painel-prontuarios">
              <div class="section-header d-flex justify-content-between align-items-center flex-wrap gap-2">
                <h2 class="h5 mb-0" id="painel-prontuarios">Prontu√°rios ‚Äî Consultar &amp; editar</h2>
                <div class="d-flex gap-2">
                  <button class="btn btn-outline-primary btn-sm" type="button"><i class="bi bi-printer me-1"></i>Imprimir</button>
                  <button class="btn btn-primary btn-sm" type="button"><i class="bi bi-upload me-1"></i>Importar dados</button>
                </div>
              </div>
              <div class="table-responsive">
                <table class="table align-middle">
                  <thead>
                    <tr>
                      <th scope="col">N¬∫</th>
                      <th scope="col">Usu√°ria</th>
                      <th scope="col">Tipifica√ß√£o principal</th>
                      <th scope="col">Encaminhamento</th>
                      <th scope="col">Atualiza√ß√£o</th>
                      <th scope="col" class="text-end">A√ß√µes</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th scope="row">2024-118</th>
                      <td>Maria Ferreira</td>
                      <td>Viol√™ncia psicol√≥gica</td>
                      <td>CREAS</td>
                      <td>10/05/2024</td>
                      <td class="text-end">
                        <button class="btn btn-sm btn-outline-secondary" type="button"><i class="bi bi-eye"></i></button>
                        <button class="btn btn-sm btn-outline-primary" type="button"><i class="bi bi-pencil"></i></button>
                      </td>
                    </tr>
                    <tr>
                      <th scope="row">2024-119</th>
                      <td>Juliana Moura</td>
                      <td>Viol√™ncia f√≠sica</td>
                      <td>Sa√∫de</td>
                      <td>08/05/2024</td>
                      <td class="text-end">
                        <button class="btn btn-sm btn-outline-secondary" type="button"><i class="bi bi-eye"></i></button>
                        <button class="btn btn-sm btn-outline-primary" type="button"><i class="bi bi-pencil"></i></button>
                      </td>
                    </tr>
                    <tr>
                      <th scope="row">2024-120</th>
                      <td>Carla Bezerra</td>
                      <td>Viol√™ncia sexual</td>
                      <td>Delegacia da Mulher</td>
                      <td>06/05/2024</td>
                      <td class="text-end">
                        <button class="btn btn-sm btn-outline-secondary" type="button"><i class="bi bi-eye"></i></button>
                        <button class="btn btn-sm btn-outline-primary" type="button"><i class="bi bi-pencil"></i></button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </section>
            <section class="card-section" aria-labelledby="historico-recentes">
              <div class="section-header">
                <h2 class="h5 mb-0" id="historico-recentes">√öltimas atualiza√ß√µes</h2>
              </div>
              <ul class="list-group list-group-flush">
                <li class="list-group-item d-flex justify-content-between align-items-start">
                  <div>
                    <h3 class="h6 mb-1">Anexo adicionado</h3>
                    <p class="mb-0 text-muted">Laudo psicossocial anexado ao prontu√°rio #2024-119.</p>
                  </div>
                  <span class="badge bg-primary-subtle text-primary">h√° 2h</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-start">
                  <div>
                    <h3 class="h6 mb-1">Encaminhamento confirmado</h3>
                    <p class="mb-0 text-muted">CREAS Sede confirmou atendimento inicial para 16/05.</p>
                  </div>
                  <span class="badge bg-success-subtle text-success">h√° 5h</span>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-start">
                  <div>
                    <h3 class="h6 mb-1">Registro atualizado</h3>
                    <p class="mb-0 text-muted">Medida protetiva renovada para prontu√°rio #2023-541.</p>
                  </div>
                  <span class="badge bg-warning-subtle text-warning">ontem</span>
                </li>
              </ul>
            </section>
          </div>

          <div class="tab-pane fade" id="bi" role="tabpanel" aria-labelledby="bi-tab">
            <div class="row g-4">
              <div class="col-12 col-xl-6">
                <section class="card-section" aria-labelledby="grafico-violencia">
                  <div class="section-header d-flex justify-content-between align-items-center">
                    <h2 class="h5 mb-0" id="grafico-violencia">Tipifica√ß√£o das viol√™ncias</h2>
                    <span class="text-muted small"><i class="bi bi-calendar3 me-1"></i>Atualizado em <span id="chartUpdate"></span></span>
                  </div>
                  <canvas id="chartViolenceTypes" role="img" aria-label="Gr√°fico de pizza das viol√™ncias"></canvas>
                  <div class="mt-3 d-flex flex-wrap gap-2" aria-hidden="true">
                    <span class="legend-badge"><span class="badge rounded-pill" style="background:#6f42c1">&nbsp;</span>Psicol√≥gica</span>
                    <span class="legend-badge"><span class="badge rounded-pill" style="background:#d63384">&nbsp;</span>F√≠sica</span>
                    <span class="legend-badge"><span class="badge rounded-pill" style="background:#fd7e14">&nbsp;</span>Sexual</span>
                    <span class="legend-badge"><span class="badge rounded-pill" style="background:#198754">&nbsp;</span>Moral</span>
                    <span class="legend-badge"><span class="badge rounded-pill" style="background:#0dcaf0">&nbsp;</span>Patrimonial</span>
                  </div>
                </section>
              </div>
              <div class="col-12 col-xl-6">
                <section class="card-section" aria-labelledby="grafico-encaminhamentos">
                  <div class="section-header d-flex justify-content-between align-items-center">
                    <h2 class="h5 mb-0" id="grafico-encaminhamentos">Encaminhamentos por rede</h2>
                    <div class="btn-group btn-group-sm" role="group" aria-label="Sele√ß√£o de per√≠odo">
                      <button class="btn btn-outline-primary active" type="button">M√™s</button>
                      <button class="btn btn-outline-primary" type="button">Trim.</button>
                      <button class="btn btn-outline-primary" type="button">Ano</button>
                    </div>
                  </div>
                  <canvas id="chartReferrals" role="img" aria-label="Gr√°fico de barras de encaminhamentos"></canvas>
                </section>
              </div>
            </div>
          </div>

          <div class="tab-pane fade" id="formulario" role="tabpanel" aria-labelledby="form-tab">
            <form id="registroForm" class="needs-validation" novalidate>
              <nav class="form-section-nav" aria-label="Navega√ß√£o entre se√ß√µes do formul√°rio">
                <span class="nav-label">Ir para</span>
                <div class="section-nav-list">
                  <a class="section-nav-link" href="#dados-preliminares" data-section="dados-preliminares"
                    ><i class="bi bi-person-vcard"></i><span>Dados preliminares</span></a
                  >
                  <a class="section-nav-link" href="#dados-endereco" data-section="dados-endereco"
                    ><i class="bi bi-geo-alt"></i><span>Endere√ßo e contatos</span></a
                  >
                  <a class="section-nav-link" href="#dados-escolaridade" data-section="dados-escolaridade"
                    ><i class="bi bi-mortarboard"></i><span>Escolaridade</span></a
                  >
                  <a class="section-nav-link" href="#caracterizacao-violencia" data-section="caracterizacao-violencia"
                    ><i class="bi bi-exclamation-triangle"></i><span>Caracteriza√ß√£o</span></a
                  >
                  <a class="section-nav-link" href="#dados-saude" data-section="dados-saude"
                    ><i class="bi bi-heart-pulse"></i><span>Sa√∫de</span></a
                  >
                  <a class="section-nav-link" href="#dados-sociais" data-section="dados-sociais"
                    ><i class="bi bi-people"></i><span>Dados sociais</span></a
                  >
                  <a class="section-nav-link" href="#dados-autor" data-section="dados-autor"
                    ><i class="bi bi-person-exclamation"></i><span>Autor(a)</span></a
                  >
                  <a class="section-nav-link" href="#tipificacao-violencia" data-section="tipificacao-violencia"
                    ><i class="bi bi-list-check"></i><span>Tipifica√ß√£o</span></a
                  >
                  <a class="section-nav-link" href="#evolucoes" data-section="evolucoes"
                    ><i class="bi bi-journal-text"></i><span>Evolu√ß√µes</span></a
                  >
                  <a class="section-nav-link" href="#dados-juridicos" data-section="dados-juridicos"
                    ><i class="bi bi-balance-scale"></i><span>Dados jur√≠dicos</span></a
                  >
                </div>
              </nav>
              <section class="card-section mb-4" aria-labelledby="dados-preliminares">
                <h2 class="form-section-title" id="dados-preliminares"><i class="bi bi-person-vcard"></i>Dados preliminares e de identifica√ß√£o</h2>
                <div class="row g-3 align-items-end">
                  <div class="col-12 col-lg-2 col-xxl-2">
                    <label for="numeroProntuario" class="form-label required">N¬∫ do prontu√°rio</label>
                    <input type="text" class="form-control" id="numeroProntuario" name="numeroProntuario" placeholder="PR-0000" required readonly />
                  </div>
                  <div class="col-12 col-lg-4 col-xxl-4">
                    <label for="demandante" class="form-label">Demandante</label>
                    <input type="text" class="form-control" id="demandante" name="demandante" placeholder="Nome do solicitante" />
                  </div>
                  <div class="col-12 col-lg-3 col-xxl-3">
                    <label for="unidadeAtendimento" class="form-label required">Unidade de atendimento</label>
                    <select id="unidadeAtendimento" name="unidadeAtendimento" class="form-select" required>
                      <option value="">Selecione</option>
                      <option>Centro de Refer√™ncia Clarice Lispector</option>
                      <option>Casa de Passagem</option>
                      <option>Casa Abrigo Sempre Viva</option>
                      <option>Outro equipamento</option>
                    </select>
                  </div>
                  <div class="col-12 col-lg-2 col-xxl-2">
                    <label for="dataAtendimento" class="form-label required">Data do atendimento</label>
                    <input type="text" class="form-control" id="dataAtendimento" name="dataAtendimento" placeholder="dd/mm/aaaa" required readonly />
                  </div>
                  <div class="col-12 col-lg-1 col-xxl-1">
                    <label for="horaAtendimento" class="form-label required">Hora do atendimento</label>
                    <input type="text" class="form-control" id="horaAtendimento" name="horaAtendimento" placeholder="HH:mm" required readonly />
                  </div>
                  <div class="col-12">
                    <span class="form-label required d-block">Avalia√ß√£o inicial</span>
                    <div class="d-flex flex-wrap gap-3" role="group" aria-label="Avalia√ß√£o inicial">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="avaliacaoInicial" id="avaliacaoRisco" value="Risco iminente" required />
                        <label class="form-check-label" for="avaliacaoRisco">Risco iminente</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="avaliacaoInicial" id="avaliacaoAcompanhamento" value="Acompanhamento" required />
                        <label class="form-check-label" for="avaliacaoAcompanhamento">Acompanhamento</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="avaliacaoInicial" id="avaliacaoOutra" value="Outra" required />
                        <label class="form-check-label" for="avaliacaoOutra">Outra</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label">Atendimento</span>
                    <div class="row g-2">
                      <div class="col-12 col-sm-6">
                        <div class="form-check">
                          <input class="form-check-input atendimento-check" type="checkbox" value="Dom√©stica/Familiar" id="atendimentoDomestica" name="atendimento[]" />
                          <label class="form-check-label" for="atendimentoDomestica">Dom√©stica/Familiar</label>
                        </div>
                      </div>
                      <div class="col-12 col-sm-6">
                        <div class="form-check">
                          <input class="form-check-input atendimento-check" type="checkbox" value="Sexista" id="atendimentoSexista" name="atendimento[]" />
                          <label class="form-check-label" for="atendimentoSexista">Sexista</label>
                        </div>
                      </div>
                      <div class="col-12 col-sm-6">
                        <div class="form-check">
                          <input class="form-check-input atendimento-check" type="checkbox" value="Acolhida/Orienta√ß√£o" id="atendimentoAcolhida" name="atendimento[]" />
                          <label class="form-check-label" for="atendimentoAcolhida">Acolhida/Orienta√ß√£o</label>
                        </div>
                      </div>
                      <div class="col-12 col-sm-6">
                        <div class="form-check">
                          <input class="form-check-input atendimento-check" type="checkbox" value="Outros Munic√≠pios" id="atendimentoOutros" name="atendimento[]" />
                          <label class="form-check-label" for="atendimentoOutros">Outros Munic√≠pios</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label">Como soube do servi√ßo</span>
                    <div class="row g-2">
                      <div class="col-12 col-sm-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="Parente" id="origemParente" name="origemServico[]" />
                          <label class="form-check-label" for="origemParente">Parente</label>
                        </div>
                      </div>
                      <div class="col-12 col-sm-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="Campanhas" id="origemCampanhas" name="origemServico[]" />
                          <label class="form-check-label" for="origemCampanhas">Campanhas</label>
                        </div>
                      </div>
                      <div class="col-12 col-sm-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="Amiga(o)" id="origemAmiga" name="origemServico[]" />
                          <label class="form-check-label" for="origemAmiga">Amiga(o)</label>
                        </div>
                      </div>
                      <div class="col-12 col-sm-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="Outras(os)" id="origemOutras" name="origemServico[]" />
                          <label class="form-check-label" for="origemOutras">Outras(os)</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-3 col-xxl-2">
                    <label for="cpfUsuario" class="form-label required">CPF</label>
                    <input type="text" class="form-control" id="cpfUsuario" name="cpfUsuario" placeholder="000.000.000-00" required />
                  </div>
                  <div class="col-12 col-lg-5 col-xxl-5">
                    <label for="nomeUsuario" class="form-label required">Nome completo</label>
                    <input type="text" class="form-control" id="nomeUsuario" name="nomeUsuario" autocomplete="name" placeholder="Nome da usu√°ria" required />
                  </div>
                  <div class="col-12 col-lg-4 col-xxl-5">
                    <label for="nomeSocial" class="form-label">Nome social</label>
                    <input type="text" class="form-control" id="nomeSocial" name="nomeSocial" placeholder="Como prefere ser chamada" />
                  </div>
                  <div class="col-12 col-md-3">
                    <label for="rgUsuario" class="form-label">RG</label>
                    <input type="text" class="form-control" id="rgUsuario" name="rgUsuario" placeholder="Documento de identidade" />
                  </div>
                  <div class="col-12 col-md-3">
                    <label for="orgaoExpedidor" class="form-label">√ìrg√£o de expedi√ß√£o</label>
                    <input type="text" class="form-control" id="orgaoExpedidor" name="orgaoExpedidor" placeholder="SSP" />
                  </div>
                  <div class="col-12 col-md-3">
                    <label for="ufExpedicao" class="form-label">UF de expedi√ß√£o</label>
                    <select id="ufExpedicao" name="ufExpedicao" class="form-select">
                      <option value="">Selecione</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-3 col-lg-2">
                    <label for="dataNascimento" class="form-label required">Data de nascimento</label>
                    <input type="text" class="form-control" id="dataNascimento" name="dataNascimento" placeholder="dd/mm/aaaa" required />
                  </div>
                  <div class="col-12 col-md-3 col-lg-2">
                    <label for="idade" class="form-label">Idade</label>
                    <input type="text" class="form-control" id="idade" name="idade" placeholder="Calculada automaticamente" readonly />
                  </div>
                  <div class="col-12 col-md-3 col-lg-3">
                    <label for="nacionalidade" class="form-label">Nacionalidade</label>
                    <input type="text" class="form-control" id="nacionalidade" name="nacionalidade" placeholder="Brasileira" />
                  </div>
                  <div class="col-12 col-md-3 col-lg-2">
                    <label for="ufNascimento" class="form-label">UF de nascimento</label>
                    <select id="ufNascimento" name="ufNascimento" class="form-select">
                      <option value="">Selecione</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-3 col-lg-3">
                    <label for="cidadeNascimento" class="form-label">Cidade de nascimento</label>
                    <select id="cidadeNascimento" name="cidadeNascimento" class="form-select">
                      <option value="">Selecione a UF primeiro</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-3">
                    <label for="estadoCivil" class="form-label">Estado civil</label>
                    <select id="estadoCivil" name="estadoCivil" class="form-select">
                      <option value="">Selecione</option>
                      <option>Solteira</option>
                      <option>Casada</option>
                      <option>Uni√£o est√°vel</option>
                      <option>Separada</option>
                      <option>Divorciada</option>
                      <option>Vi√∫va</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-6">
                    <label for="conjuge" class="form-label">Nome do(a) c√¥njuge/companheiro(a)</label>
                    <input type="text" class="form-control" id="conjuge" name="conjuge" placeholder="Nome do(a) companheiro(a)" />
                  </div>
                  <div class="col-12 col-lg-3">
                    <label for="identidadeGenero" class="form-label">Identidade de g√™nero</label>
                    <select id="identidadeGenero" name="identidadeGenero" class="form-select">
                      <option value="">Selecione</option>
                      <option>Mulher cisg√™nero</option>
                      <option>Mulher trans</option>
                      <option>Travesti</option>
                      <option>N√£o-bin√°ria</option>
                      <option>Outra</option>
                      <option>Prefere n√£o informar</option>
                    </select>
                  </div>
                  <div class="col-12 col-lg-3">
                    <label for="orientacaoSexual" class="form-label">Orienta√ß√£o sexual</label>
                    <select id="orientacaoSexual" name="orientacaoSexual" class="form-select">
                      <option value="">Selecione</option>
                      <option>Heterossexual</option>
                      <option>L√©sbica</option>
                      <option>Bissexual</option>
                      <option>Assexual</option>
                      <option>Outra</option>
                      <option>Prefere n√£o informar</option>
                    </select>
                  </div>
                  <div class="col-12 col-lg-3">
                    <label for="corRaca" class="form-label">Cor/ra√ßa</label>
                    <select id="corRaca" name="corRaca" class="form-select">
                      <option value="">Selecione</option>
                      <option>Branca</option>
                      <option>Preta</option>
                      <option>Parda</option>
                      <option>Amarela</option>
                      <option>Ind√≠gena</option>
                      <option>Prefere n√£o informar</option>
                    </select>
                  </div>
                  <div class="col-12 col-lg-3">
                    <label for="religiao" class="form-label">Religi√£o</label>
                    <select id="religiao" name="religiao" class="form-select">
                      <option value="">Selecione</option>
                      <option>Cat√≥lica</option>
                      <option>Evang√©lica</option>
                      <option>Esp√≠rita</option>
                      <option>Religi√µes de matriz africana</option>
                      <option>Outra</option>
                      <option>Sem religi√£o</option>
                      <option>Prefere n√£o informar</option>
                    </select>
                  </div>
                  <div class="col-12">
                    <div class="row g-3 align-items-end">
                      <div class="col-12 col-md-6">
                        <label for="nomeMae" class="form-label">Nome da m√£e</label>
                        <input type="text" class="form-control" id="nomeMae" name="nomeMae" placeholder="Nome completo" />
                      </div>
                      <div class="col-12 col-md-6">
                        <label for="nomePai" class="form-label">Nome do pai</label>
                        <input type="text" class="form-control" id="nomePai" name="nomePai" placeholder="Nome completo" />
                      </div>
                    </div>
                  </div>
                </div>
              </section>

              <section class="card-section mb-4" aria-labelledby="dados-endereco">
                <h2 class="form-section-title" id="dados-endereco"><i class="bi bi-geo-alt"></i>Dados de endere√ßo e contatos</h2>
                <div class="row g-3">
                  <div class="col-12">
                    <div class="row g-3 align-items-end">
                      <div class="col-12 col-md-3 col-xl-2">
                        <label for="cep" class="form-label required">CEP</label>
                        <input type="text" class="form-control" id="cep" name="cep" placeholder="00000-000" required aria-describedby="cepHelp" />
                        <div id="cepHelp" class="form-text"></div>
                      </div>
                      <div class="col-12 col-md-5 col-xl-5">
                        <label for="logradouro" class="form-label required">Logradouro</label>
                        <input type="text" class="form-control" id="logradouro" name="logradouro" placeholder="Rua, avenida, travessa" required />
                      </div>
                      <div class="col-12 col-md-2 col-xl-2">
                        <label for="numeroEndereco" class="form-label">N√∫mero</label>
                        <input type="text" class="form-control" id="numeroEndereco" name="numeroEndereco" placeholder="000" />
                      </div>
                      <div class="col-12 col-md-2 col-xl-3">
                        <label for="complementoEndereco" class="form-label">Complemento</label>
                        <input type="text" class="form-control" id="complementoEndereco" name="complementoEndereco" placeholder="Apto, bloco" />
                      </div>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="row g-3">
                      <div class="col-12 col-md-3">
                        <label for="bairro" class="form-label required">Bairro</label>
                        <input type="text" class="form-control" id="bairro" name="bairro" required />
                      </div>
                      <div class="col-12 col-md-2">
                        <label for="rpa" class="form-label">RPA</label>
                        <input type="text" class="form-control" id="rpa" name="rpa" placeholder="Ex.: RPA 1" />
                      </div>
                      <div class="col-12 col-md-3">
                        <label for="cidade" class="form-label required">Cidade</label>
                        <input type="text" class="form-control" id="cidade" name="cidade" required />
                      </div>
                      <div class="col-12 col-md-2">
                        <label for="uf" class="form-label required">UF</label>
                        <select id="uf" name="uf" class="form-select" required>
                          <option value="">UF</option>
                        </select>
                      </div>
                      <div class="col-12 col-md-2">
                        <label for="pontoReferencia" class="form-label">Ponto de refer√™ncia</label>
                        <input type="text" class="form-control" id="pontoReferencia" name="pontoReferencia" placeholder="Pr√≥ximo a..." />
                      </div>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="row g-3">
                      <div class="col-12 col-md-3 col-xl-3">
                        <label for="telefone" class="form-label">Telefone principal</label>
                        <input type="text" class="form-control" id="telefone" name="telefone" placeholder="(00) 00000-0000" />
                      </div>
                      <div class="col-12 col-md-3 col-xl-3">
                        <label for="telefoneSecundario" class="form-label">Telefone alternativo</label>
                        <input type="text" class="form-control" id="telefoneSecundario" name="telefoneSecundario" placeholder="(00) 00000-0000" />
                      </div>
                      <div class="col-12 col-md-3 col-xl-3">
                        <label for="email" class="form-label">E-mail</label>
                        <input type="email" class="form-control" id="email" name="email" placeholder="nome@email.com" />
                      </div>
                      <div class="col-12 col-md-3 col-xl-3">
                        <label for="emailConfirmacao" class="form-label">Confirma√ß√£o de e-mail</label>
                        <input type="email" class="form-control" id="emailConfirmacao" name="emailConfirmacao" placeholder="Repita o e-mail" aria-describedby="emailConfirmacaoHelp" />
                        <div id="emailConfirmacaoHelp" class="form-text">Informe o mesmo endere√ßo para confirma√ß√£o.</div>
                      </div>
                    </div>
                  </div>
                </div>
              </section>

              <section class="card-section mb-4" aria-labelledby="dados-escolaridade">
                <h2 class="form-section-title" id="dados-escolaridade"><i class="bi bi-mortarboard"></i>Dados de escolaridade e profissionais</h2>
                <div class="row g-4">
                  <div class="col-12 col-xl-6">
                    <div class="subsection-card h-100">
                      <h3 class="subsection-heading">Escolariza√ß√£o</h3>
                      <div class="row g-3">
                        <div class="col-12">
                          <label for="escolaridade" class="form-label required">Escolaridade</label>
                          <select id="escolaridade" name="escolaridade" class="form-select" required>
                            <option value="">Selecione</option>
                            <option>Sem instru√ß√£o</option>
                            <option>Ensino fundamental</option>
                            <option>Ensino m√©dio</option>
                            <option>Curso t√©cnico</option>
                            <option>Tecn√≥logo</option>
                            <option>Ensino superior</option>
                            <option>P√≥s-gradua√ß√£o</option>
                            <option>Mestrado</option>
                            <option>Doutorado</option>
                          </select>
                        </div>
                        <div class="col-12 col-md-6 d-none" id="situacaoEscolarGroup">
                          <label for="situacaoEscolar" class="form-label">Situa√ß√£o escolar</label>
                          <select id="situacaoEscolar" name="situacaoEscolar" class="form-select">
                            <option value="">Selecione</option>
                            <option>Conclu√≠do</option>
                            <option>Em andamento</option>
                            <option>Interrompido</option>
                          </select>
                        </div>
                        <div class="col-12 col-md-6 d-none" id="cursoFormacaoGroup">
                          <label for="cursoFormacao" class="form-label">Curso</label>
                          <input type="text" class="form-control" id="cursoFormacao" name="cursoFormacao" placeholder="Informe o curso" />
                        </div>
                        <div class="col-12 col-md-6 d-none" id="tipoPosGraduacaoGroup">
                          <label for="tipoPosGraduacao" class="form-label">Tipo de p√≥s-gradua√ß√£o</label>
                          <select id="tipoPosGraduacao" name="tipoPosGraduacao" class="form-select">
                            <option value="">Selecione</option>
                            <option>Especializa√ß√£o</option>
                            <option>Mestrado</option>
                            <option>Doutorado</option>
                            <option>Outra</option>
                          </select>
                        </div>
                        <div class="col-12 col-md-6 d-none" id="anoPeriodoGroup">
                          <label for="anoPeriodo" class="form-label">Ano/per√≠odo</label>
                          <input type="text" class="form-control" id="anoPeriodo" name="anoPeriodo" placeholder="Ex.: 3¬∫ per√≠odo" />
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-xl-6">
                    <div class="subsection-card h-100">
                      <h3 class="subsection-heading">Trabalho e renda</h3>
                      <div class="row g-3">
                        <div class="col-12">
                          <label for="situacaoOcupacional" class="form-label">Situa√ß√£o ocupacional</label>
                          <select id="situacaoOcupacional" name="situacaoOcupacional" class="form-select">
                            <option value="">Selecione</option>
                            <option>Empregada com carteira</option>
                            <option>Empregada informal</option>
                            <option>Aut√¥noma</option>
                            <option>Estudante</option>
                            <option>Dona de casa/cuidadora</option>
                            <option>Desempregada</option>
                            <option>Aposentada/Pensionista</option>
                          </select>
                        </div>
                      </div>
                      <div class="row g-3 mt-1 d-none" id="detalhesTrabalho">
                        <div class="col-12 col-md-6">
                          <label for="profissao" class="form-label">Ocupa√ß√£o/profiss√£o</label>
                          <input type="text" class="form-control" id="profissao" name="profissao" placeholder="Profiss√£o atual" />
                        </div>
                        <div class="col-12 col-md-6">
                          <label for="situacaoTrabalho" class="form-label">Situa√ß√£o trabalhista</label>
                          <select id="situacaoTrabalho" name="situacaoTrabalho" class="form-select">
                            <option value="">Selecione</option>
                            <option>Com carteira assinada</option>
                            <option>Aut√¥noma</option>
                            <option>Microempreendedora</option>
                            <option>Desempregada</option>
                            <option>Trabalho dom√©stico</option>
                          </select>
                        </div>
                        <div class="col-12 col-md-6">
                          <label for="rendaIndividual" class="form-label">Renda individual</label>
                          <input type="text" class="form-control" id="rendaIndividual" name="rendaIndividual" placeholder="R$ 0,00" />
                        </div>
                      </div>
                      <div class="mt-3">
                        <span class="form-label d-block">Interesse em capacita√ß√£o profissional</span>
                        <div class="d-flex flex-wrap gap-3" role="radiogroup" aria-label="Interesse em capacita√ß√£o profissional">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="interesseCapacitacao" id="capacitacaoSim" value="Sim" />
                            <label class="form-check-label" for="capacitacaoSim">Sim</label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="interesseCapacitacao" id="capacitacaoNao" value="N√£o" />
                            <label class="form-check-label" for="capacitacaoNao">N√£o</label>
                          </div>
                        </div>
                      </div>
                      <div class="mt-3 d-none" id="cursosWrapper">
                        <label for="cursoCapacitacao" class="form-label required">Curso de interesse</label>
                        <div class="d-flex flex-column gap-2">
                          <input type="text" class="form-control" id="cursoCapacitacao" name="cursos[]" placeholder="Ex.: Inform√°tica b√°sica" />
                          <div id="cursosExtras" class="d-flex flex-column gap-2"></div>
                          <button type="button" class="btn btn-sm btn-outline-primary align-self-start" id="adicionarCurso" aria-describedby="cursoHelp">
                            <i class="bi bi-plus-circle me-1"></i>Adicionar outro
                          </button>
                          <div id="cursoHelp" class="form-text">√â poss√≠vel cadastrar at√© tr√™s cursos de interesse.</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </section>

              <section class="card-section mb-4" aria-labelledby="caracterizacao-violencia">
                <h2 class="form-section-title" id="caracterizacao-violencia"><i class="bi bi-exclamation-triangle"></i>Caracteriza√ß√£o da viol√™ncia</h2>
                <div class="row g-3">
                  <div class="col-12 col-md-4">
                    <label for="tipoViolencia" class="form-label required">Tipo de viol√™ncia</label>
                    <select id="tipoViolencia" name="tipoViolencia" class="form-select" required>
                      <option value="">Selecione</option>
                      <option>Viol√™ncia f√≠sica</option>
                      <option>Viol√™ncia psicol√≥gica</option>
                      <option>Viol√™ncia sexual</option>
                      <option>Viol√™ncia moral</option>
                      <option>Viol√™ncia patrimonial</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-4">
                    <label for="localViolencia" class="form-label required">Local principal</label>
                    <input type="text" class="form-control" id="localViolencia" name="localViolencia" required />
                  </div>
                  <div class="col-12 col-md-4">
                    <label for="frequencia" class="form-label">Frequ√™ncia</label>
                    <select id="frequencia" name="frequencia" class="form-select">
                      <option value="">Selecione</option>
                      <option>Recente</option>
                      <option>Recorrente</option>
                      <option>Eventual</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-4">
                    <label for="dataOcorrencia" class="form-label">Data da √∫ltima ocorr√™ncia</label>
                    <input type="text" class="form-control" id="dataOcorrencia" name="dataOcorrencia" placeholder="dd/mm/aaaa" />
                  </div>
                  <div class="col-12">
                    <label for="relato" class="form-label">Relato resumido</label>
                    <textarea id="relato" name="relato" class="form-control" rows="3" placeholder="Descreva a situa√ß√£o de viol√™ncia..."></textarea>
                  </div>
                  <div class="col-12">
                    <div class="alert alert-info d-none" id="encaminhamentosAlert" role="status">
                      <strong>Encaminhamentos priorit√°rios:</strong> orientar acolhida imediata, registrar encaminhamento para rede municipal e comunicar munic√≠pio de origem quando aplic√°vel.
                    </div>
                  </div>
                </div>
              </section>

              <section class="card-section mb-4" aria-labelledby="dados-saude">
                <h2 class="form-section-title" id="dados-saude"><i class="bi bi-heart-pulse"></i>Dados de sa√∫de</h2>
                <div class="row g-3">
                  <div class="col-12 col-lg-4">
                    <label for="numeroSus" class="form-label required">N√∫mero do Cart√£o SUS</label>
                    <input
                      type="text"
                      class="form-control"
                      id="numeroSus"
                      name="numeroSus"
                      placeholder="Digite o n√∫mero completo"
                      required
                    />
                  </div>
                  <div class="col-12 col-lg-4">
                    <span class="form-label required d-block">Apresenta alguma defici√™ncia/s√≠ndrome?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup" aria-labelledby="dados-saude">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="deficienciaSindrome" id="deficienciaSim" value="Sim" />
                        <label class="form-check-label" for="deficienciaSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="deficienciaSindrome" id="deficienciaNao" value="N√£o" />
                        <label class="form-check-label" for="deficienciaNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-4">
                    <span class="form-label d-block">Defici√™ncia em decorr√™ncia da viol√™ncia sofrida?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="deficienciaViolencia" id="deficienciaViolenciaSim" value="Sim" />
                        <label class="form-check-label" for="deficienciaViolenciaSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="deficienciaViolencia" id="deficienciaViolenciaNao" value="N√£o" />
                        <label class="form-check-label" for="deficienciaViolenciaNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="deficienciaQualGroup">
                    <label for="deficienciaQual" class="form-label required">Qual?</label>
                    <select id="deficienciaQual" name="deficienciaQual" class="form-select" data-choices="true">
                      <option value="">Selecione</option>
                      <option>Defici√™ncia f√≠sica</option>
                      <option>Defici√™ncia auditiva</option>
                      <option>Defici√™ncia visual</option>
                      <option>Defici√™ncia intelectual</option>
                      <option>Defici√™ncia psicossocial</option>
                      <option>Transtorno do espectro autista</option>
                      <option>Outra defici√™ncia</option>
                    </select>
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">Apresenta problema de sa√∫de?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="problemaSaude" id="problemaSaudeSim" value="Sim" />
                        <label class="form-check-label" for="problemaSaudeSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="problemaSaude" id="problemaSaudeNao" value="N√£o" />
                        <label class="form-check-label" for="problemaSaudeNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="problemaSaudeQualGroup">
                    <label for="problemaSaudeQual" class="form-label required">Qual?</label>
                    <input
                      type="text"
                      class="form-control"
                      id="problemaSaudeQual"
                      name="problemaSaudeQual"
                      placeholder="Descreva a condi√ß√£o"
                    />
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">J√° foi atendido por psic√≥logo?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="atendimentoPsicologo" id="atendimentoPsicologoSim" value="Sim" />
                        <label class="form-check-label" for="atendimentoPsicologoSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="atendimentoPsicologo" id="atendimentoPsicologoNao" value="N√£o" />
                        <label class="form-check-label" for="atendimentoPsicologoNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="tempoPsicologoGroup">
                    <label for="tempoPsicologo" class="form-label required">Quanto tempo?</label>
                    <input
                      type="text"
                      class="form-control"
                      id="tempoPsicologo"
                      name="tempoPsicologo"
                      placeholder="Ex.: 6 meses"
                    />
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">J√° foi atendido por psiquiatra?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="atendimentoPsiquiatra" id="atendimentoPsiquiatraSim" value="Sim" />
                        <label class="form-check-label" for="atendimentoPsiquiatraSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="atendimentoPsiquiatra" id="atendimentoPsiquiatraNao" value="N√£o" />
                        <label class="form-check-label" for="atendimentoPsiquiatraNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="tempoPsiquiatraGroup">
                    <label for="tempoPsiquiatra" class="form-label required">Quanto tempo?</label>
                    <input
                      type="text"
                      class="form-control"
                      id="tempoPsiquiatra"
                      name="tempoPsiquiatra"
                      placeholder="Ex.: 1 ano"
                    />
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">Faz uso de medicamento?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="usoMedicamento" id="usoMedicamentoSim" value="Sim" />
                        <label class="form-check-label" for="usoMedicamentoSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="usoMedicamento" id="usoMedicamentoNao" value="N√£o" />
                        <label class="form-check-label" for="usoMedicamentoNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="medicamentosQuaisGroup">
                    <label for="medicamentosQuais" class="form-label required">Quais?</label>
                    <input
                      type="text"
                      class="form-control"
                      id="medicamentosQuais"
                      name="medicamentosQuais"
                      placeholder="Liste os medicamentos em uso"
                    />
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">Faz uso de drogas l√≠citas?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="usoDrogasLicitas" id="usoDrogasLicitasSim" value="Sim" />
                        <label class="form-check-label" for="usoDrogasLicitasSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="usoDrogasLicitas" id="usoDrogasLicitasNao" value="N√£o" />
                        <label class="form-check-label" for="usoDrogasLicitasNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="drogasLicitasGroup">
                    <span class="form-label required d-block">Quais?</span>
                    <div class="row g-2">
                      <div class="col-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="drogaLicitaTabaco" name="drogasLicitas[]" value="Tabaco" />
                          <label class="form-check-label" for="drogaLicitaTabaco">Tabaco</label>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="drogaLicitaMedicamento" name="drogasLicitas[]" value="Medicamento" />
                          <label class="form-check-label" for="drogaLicitaMedicamento">Medicamento</label>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="drogaLicitaAlcool" name="drogasLicitas[]" value="√Ålcool" />
                          <label class="form-check-label" for="drogaLicitaAlcool">√Ålcool</label>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="drogaLicitaOutras" name="drogasLicitas[]" value="Outras" />
                          <label class="form-check-label" for="drogaLicitaOutras">Outras</label>
                        </div>
                      </div>
                      <div class="col-12 d-none" id="drogasLicitasOutrasGroup">
                        <label for="drogasLicitasOutrasTexto" class="form-label required">Outras (especifique)</label>
                        <input
                          type="text"
                          class="form-control"
                          id="drogasLicitasOutrasTexto"
                          name="drogasLicitasOutrasTexto"
                          placeholder="Informe outras drogas l√≠citas"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">Faz uso de drogas il√≠citas?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="usoDrogasIlicitas" id="usoDrogasIlicitasSim" value="Sim" />
                        <label class="form-check-label" for="usoDrogasIlicitasSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="usoDrogasIlicitas" id="usoDrogasIlicitasNao" value="N√£o" />
                        <label class="form-check-label" for="usoDrogasIlicitasNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="drogasIlicitasGroup">
                    <span class="form-label required d-block">Quais?</span>
                    <div class="row g-2">
                      <div class="col-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="drogaIlicitaCocaina" name="drogasIlicitas[]" value="Coca√≠na" />
                          <label class="form-check-label" for="drogaIlicitaCocaina">Coca√≠na</label>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="drogaIlicitaCrack" name="drogasIlicitas[]" value="Crack" />
                          <label class="form-check-label" for="drogaIlicitaCrack">Crack</label>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="drogaIlicitaMaconha" name="drogasIlicitas[]" value="Maconha" />
                          <label class="form-check-label" for="drogaIlicitaMaconha">Maconha</label>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="drogaIlicitaOutras" name="drogasIlicitas[]" value="Outras" />
                          <label class="form-check-label" for="drogaIlicitaOutras">Outras</label>
                        </div>
                      </div>
                      <div class="col-12 d-none" id="drogasIlicitasOutrasGroup">
                        <label for="drogasIlicitasOutrasTexto" class="form-label required">Outras (especifique)</label>
                        <input
                          type="text"
                          class="form-control"
                          id="drogasIlicitasOutrasTexto"
                          name="drogasIlicitasOutrasTexto"
                          placeholder="Informe outras drogas il√≠citas"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">Gestante?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="gestante" id="gestanteSim" value="Sim" />
                        <label class="form-check-label" for="gestanteSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="gestante" id="gestanteNao" value="N√£o" />
                        <label class="form-check-label" for="gestanteNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="tempoGestacaoGroup">
                    <label for="tempoGestacao" class="form-label required">Tempo de gesta√ß√£o</label>
                    <select id="tempoGestacao" name="tempoGestacao" class="form-select" data-choices="true">
                      <option value="">Selecione</option>
                      <option>At√© 12 semanas</option>
                      <option>13 a 20 semanas</option>
                      <option>21 a 28 semanas</option>
                      <option>29 a 36 semanas</option>
                      <option>37 semanas ou mais</option>
                    </select>
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">Decorrente de viol√™ncia, j√° sofreu algum aborto?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="abortoViolencia" id="abortoViolenciaSim" value="Sim" />
                        <label class="form-check-label" for="abortoViolenciaSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="abortoViolencia" id="abortoViolenciaNao" value="N√£o" />
                        <label class="form-check-label" for="abortoViolenciaNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="preventivoGroup">
                    <span class="form-label d-block">Preventivo c√¢ncer do colo do √∫tero</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="preventivoColo" id="preventivoColoSim" value="Sim" />
                        <label class="form-check-label" for="preventivoColoSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="preventivoColo" id="preventivoColoNao" value="N√£o" />
                        <label class="form-check-label" for="preventivoColoNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="preventivoAnoGroup">
                    <label for="preventivoAno" class="form-label required">Quando (ano)?</label>
                    <input type="text" class="form-control" id="preventivoAno" name="preventivoAno" placeholder="Ex.: 2023" />
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="mamografiaGroup">
                    <span class="form-label d-block">Mamografia</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="mamografia" id="mamografiaSim" value="Sim" />
                        <label class="form-check-label" for="mamografiaSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="mamografia" id="mamografiaNao" value="N√£o" />
                        <label class="form-check-label" for="mamografiaNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="mamografiaAnoGroup">
                    <label for="mamografiaAno" class="form-label required">Quando (ano)?</label>
                    <input type="text" class="form-control" id="mamografiaAno" name="mamografiaAno" placeholder="Ex.: 2022" />
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">Realizou exame de HIV?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="exameHiv" id="exameHivSim" value="Sim" />
                        <label class="form-check-label" for="exameHivSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="exameHiv" id="exameHivNao" value="N√£o" />
                        <label class="form-check-label" for="exameHivNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="resultadoHivGroup">
                    <span class="form-label required d-block">Qual o resultado?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="resultadoHiv" id="resultadoHivNegativo" value="Negativo" />
                        <label class="form-check-label" for="resultadoHivNegativo">Negativo</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="resultadoHiv" id="resultadoHivPositivo" value="Positivo" />
                        <label class="form-check-label" for="resultadoHivPositivo">Positivo</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="contraiuAgressorGroup">
                    <span class="form-label required d-block">Contraiu com o agressor?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="contraiuAgressor" id="contraiuAgressorSim" value="Sim" />
                        <label class="form-check-label" for="contraiuAgressorSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="contraiuAgressor" id="contraiuAgressorNao" value="N√£o" />
                        <label class="form-check-label" for="contraiuAgressorNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6">
                    <span class="form-label required d-block">Faz acompanhamento?</span>
                    <div class="d-flex flex-wrap gap-3" role="radiogroup">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="acompanhamentoSaudeContinuo" id="acompanhamentoSaudeContinuoSim" value="Sim" />
                        <label class="form-check-label" for="acompanhamentoSaudeContinuoSim">Sim</label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="acompanhamentoSaudeContinuo" id="acompanhamentoSaudeContinuoNao" value="N√£o" />
                        <label class="form-check-label" for="acompanhamentoSaudeContinuoNao">N√£o</label>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-lg-6 d-none" id="tempoAcompanhamentoGroup">
                    <label for="tempoAcompanhamento" class="form-label required">H√° quanto tempo faz tratamento?</label>
                    <select id="tempoAcompanhamento" name="tempoAcompanhamento" class="form-select" data-choices="true">
                      <option value="">Selecione</option>
                      <option>Menos de 6 meses</option>
                      <option>Entre 6 meses e 1 ano</option>
                      <option>Entre 1 e 2 anos</option>
                      <option>Mais de 2 anos</option>
                    </select>
                  </div>
                </div>
              </section>

              <section class="card-section mb-4" aria-labelledby="dados-sociais">
                <h2 class="form-section-title" id="dados-sociais"><i class="bi bi-people"></i>Dados sociais da fam√≠lia</h2>
                <div class="row g-3">
                  <div class="col-12 col-md-4">
                    <label for="beneficios" class="form-label">Benef√≠cios sociais</label>
                    <select id="beneficios" name="beneficios" class="form-select" aria-describedby="beneficiosHelp">
                      <option value="">Selecione</option>
                      <option>Bolsa Fam√≠lia</option>
                      <option>BPC</option>
                      <option>Aux√≠lio municipal</option>
                      <option>Outro</option>
                    </select>
                    <div id="beneficiosHelp" class="form-text">Selecione o principal benef√≠cio recebido.</div>
                  </div>
                  <div class="col-12 col-md-4">
                    <label for="totalFilhos" class="form-label">Total de filhos(as)</label>
                    <select id="totalFilhos" name="totalFilhos" class="form-select">
                      <option value="">Selecione</option>
                      <option>0</option>
                      <option>1</option>
                      <option>2</option>
                      <option>3</option>
                      <option>4 ou mais</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-4">
                    <label for="rendaFamiliar" class="form-label">Renda familiar</label>
                    <select id="rendaFamiliar" name="rendaFamiliar" class="form-select">
                      <option value="">Selecione</option>
                      <option>At√© 1 sal√°rio m√≠nimo</option>
                      <option>De 1 a 2 sal√°rios m√≠nimos</option>
                      <option>De 2 a 3 sal√°rios m√≠nimos</option>
                      <option>Acima de 3 sal√°rios m√≠nimos</option>
                      <option>Sem renda</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-4">
                    <label for="situacaoHabitacional" class="form-label">Situa√ß√£o habitacional</label>
                    <select id="situacaoHabitacional" name="situacaoHabitacional" class="form-select">
                      <option value="">Selecione</option>
                      <option>Pr√≥pria</option>
                      <option>Alugada</option>
                      <option>Cedida</option>
                      <option>Ocupa√ß√£o</option>
                      <option>Outros</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-4 d-none" id="situacaoHabitacionalOutroGroup">
                    <label for="situacaoHabitacionalOutro" class="form-label">Descreva a situa√ß√£o habitacional</label>
                    <input type="text" class="form-control" id="situacaoHabitacionalOutro" name="situacaoHabitacionalOutro" placeholder="Informe a situa√ß√£o" />
                  </div>
                  <div class="col-12 col-md-4">
                    <label for="redeApoio" class="form-label">Rede de apoio</label>
                    <input type="text" class="form-control" id="redeApoio" name="redeApoio" placeholder="Familiares, vizinhan√ßa..." />
                  </div>
                </div>
                <div class="mt-4">
                  <div class="d-flex flex-wrap align-items-center gap-3 mb-3">
                    <h3 class="h6 mb-0">Composi√ß√£o familiar (todos da resid√™ncia)</h3>
                    <button type="button" class="btn btn-outline-primary btn-sm ms-auto" id="adicionarMembroFamilia">
                      <i class="bi bi-person-plus me-1"></i>Adicionar membro da fam√≠lia
                    </button>
                  </div>
                  <div class="table-responsive border rounded-3">
                    <table class="table table-sm align-middle mb-0">
                      <thead class="table-light">
                        <tr>
                          <th scope="col">Nome completo</th>
                          <th scope="col">Parentesco</th>
                          <th scope="col">Idade (anos)</th>
                          <th scope="col">Meses</th>
                        </tr>
                      </thead>
                      <tbody id="familiaTabelaBody">
                        <tr id="familiaVazia">
                          <td colspan="4" class="text-center text-muted">Nenhum membro informado.</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div id="familiaHiddenInputs"></div>
                </div>
              </section>

              <section class="card-section mb-4" aria-labelledby="dados-autor">
                <h2 class="form-section-title" id="dados-autor"><i class="bi bi-person-exclamation"></i>Dados do(a) autor(a)</h2>
                <div class="row g-3">
                  <div class="col-12 col-md-6">
                    <label for="relacaoAutor" class="form-label required">Rela√ß√£o com a usu√°ria</label>
                    <select id="relacaoAutor" name="relacaoAutor" class="form-select" required>
                      <option value="">Selecione</option>
                      <option>Convivente/C√¥njuge</option>
                      <option>Ex-companheiro(a)</option>
                      <option>Familiar</option>
                      <option>Outro</option>
                    </select>
                  </div>
                  <div class="col-12 col-md-6">
                    <label for="medidaRestritiva" class="form-label">Medida protetiva vigente?</label>
                    <select id="medidaRestritiva" name="medidaRestritiva" class="form-select">
                      <option value="">Selecione</option>
                      <option>Sim</option>
                      <option>N√£o</option>
                      <option>Solicitada</option>
                    </select>
                  </div>
                  <div class="col-12">
                    <label for="historicoAutor" class="form-label">Hist√≥rico conhecido</label>
                    <textarea id="historicoAutor" name="historicoAutor" class="form-control" rows="3"></textarea>
                  </div>
                </div>
              </section>

              <section class="card-section mb-4" aria-labelledby="tipificacao-violencia">
                <h2 class="form-section-title" id="tipificacao-violencia"><i class="bi bi-list-check"></i>Tipifica√ß√£o da viol√™ncia</h2>
                <div class="row g-3">
                  <div class="col-12">
                    <label class="form-label required">Tipos identificados</label>
                    <div class="row">
                      <div class="col-12 col-md-4">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="fisica" id="violenciaFisica" name="tiposViolencia" />
                          <label class="form-check-label" for="violenciaFisica">Viol√™ncia f√≠sica</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="psicologica" id="violenciaPsicologica" name="tiposViolencia" />
                          <label class="form-check-label" for="violenciaPsicologica">Viol√™ncia psicol√≥gica</label>
                        </div>
                      </div>
                      <div class="col-12 col-md-4">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="sexual" id="violenciaSexual" name="tiposViolencia" />
                          <label class="form-check-label" for="violenciaSexual">Viol√™ncia sexual</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="moral" id="violenciaMoral" name="tiposViolencia" />
                          <label class="form-check-label" for="violenciaMoral">Viol√™ncia moral</label>
                        </div>
                      </div>
                      <div class="col-12 col-md-4">
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="patrimonial" id="violenciaPatrimonial" name="tiposViolencia" />
                          <label class="form-check-label" for="violenciaPatrimonial">Viol√™ncia patrimonial</label>
                        </div>
                        <div class="form-check">
                          <input class="form-check-input" type="checkbox" value="outra" id="violenciaOutra" name="tiposViolencia" />
                          <label class="form-check-label" for="violenciaOutra">Outra</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-12 col-md-6">
                    <label for="localFato" class="form-label">Local da ocorr√™ncia</label>
                    <input type="text" class="form-control" id="localFato" name="localFato" />
                  </div>
                  <div class="col-12 col-md-6">
                    <label for="horarioFato" class="form-label">Hor√°rio</label>
                    <input type="time" class="form-control" id="horarioFato" name="horarioFato" />
                  </div>
                  <div class="col-12">
                    <label for="fatoresRelacionados" class="form-label">Fatores relacionados</label>
                    <textarea id="fatoresRelacionados" name="fatoresRelacionados" class="form-control" rows="2" placeholder="Ex.: uso de √°lcool, ci√∫mes, disputa patrimonial..."></textarea>
                  </div>
                </div>
              </section>

              <section class="card-section mb-4" aria-labelledby="evolucoes">
                <h2 class="form-section-title" id="evolucoes"><i class="bi bi-journal-text"></i>Evolu√ß√µes / Consolidado</h2>
                <p class="text-muted mb-0">Registros de evolu√ß√µes e consolidado ser√£o preenchidos pela equipe t√©cnica ap√≥s o atendimento inicial. Utilize o m√≥dulo de prontu√°rios para acompanhar as atualiza√ß√µes.</p>
              </section>

              <section class="card-section mb-4" aria-labelledby="dados-juridicos">
                <h2 class="form-section-title" id="dados-juridicos"><i class="bi bi-balance-scale"></i>Dados jur√≠dicos</h2>
                <div class="row g-3">
                  <div class="col-12 col-md-6">
                    <label for="delegacia" class="form-label">Delegacia respons√°vel</label>
                    <input type="text" class="form-control" id="delegacia" name="delegacia" />
                  </div>
                  <div class="col-12 col-md-6">
                    <label for="numeroBoletim" class="form-label">N√∫mero do boletim</label>
                    <input type="text" class="form-control" id="numeroBoletim" name="numeroBoletim" />
                  </div>
                  <div class="col-12 col-md-6">
                    <label for="medidasProtetivas" class="form-label">Medidas protetivas solicitadas</label>
                    <input type="text" class="form-control" id="medidasProtetivas" name="medidasProtetivas" />
                  </div>
                  <div class="col-12 col-md-6">
                    <label for="encaminhamentos" class="form-label">Encaminhamentos realizados</label>
                    <input type="text" class="form-control" id="encaminhamentos" name="encaminhamentos" />
                  </div>
                </div>
              </section>

              <div class="d-flex justify-content-end gap-2">
                <button type="reset" class="btn btn-outline-secondary">Limpar</button>
                <button type="submit" class="btn btn-primary">
                  <i class="bi bi-send me-2"></i>
                  Enviar registro
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </main>

    <footer class="border-top bg-white">
      <div class="container">
        <div class="row g-3 align-items-center">
          <div class="col-12 col-lg-8">
            <p class="mb-0">Secretaria da Mulher ‚Äî Centro de Refer√™ncia Clarice Lispector. Rede de Enfrentamento √† Viol√™ncia Contra a Mulher do Recife.</p>
          </div>
          <div class="col-12 col-lg-4 text-lg-end">
            <p class="mb-0">Contato: redeclarice@recife.pe.gov.br ‚Ä¢ (81) 0000-0000</p>
          </div>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const tabTriggerList = [].slice.call(document.querySelectorAll('#portalTabs button[data-bs-toggle="tab"]'));
        tabTriggerList.forEach((tabTriggerEl) => {
          tabTriggerEl.addEventListener('shown.bs.tab', (event) => {
            event.target.classList.add('active');
            if (event.target.id === 'form-tab') {
              setCurrentDateTime();
            }
          });
        });

        const updateLabel = document.getElementById('chartUpdate');
        if (updateLabel && window.dayjs) {
          updateLabel.textContent = dayjs().format('DD/MM/YYYY HH:mm');
        }

        const sectionNavLinks = document.querySelectorAll('.section-nav-link');
        if (sectionNavLinks.length) {
          const canObserve = 'IntersectionObserver' in window;
          let observer = null;
          const setActiveLink = (target) => {
            sectionNavLinks.forEach((link) => {
              const isActive = link === target;
              link.classList.toggle('active', isActive);
              if (isActive) {
                link.setAttribute('aria-current', 'true');
              } else {
                link.removeAttribute('aria-current');
              }
            });
          };
          if (canObserve) {
            observer = new IntersectionObserver(
              (entries) => {
                entries.forEach((entry) => {
                  if (entry.isIntersecting) {
                    const id = entry.target.dataset.sectionId || entry.target.id;
                    const targetLink = Array.from(sectionNavLinks).find((link) => link.dataset.section === id);
                    if (targetLink) {
                      setActiveLink(targetLink);
                    }
                  }
                });
              },
              { rootMargin: '-55% 0px -35% 0px', threshold: 0.25 }
            );
          }

          let defaultLink = null;
          sectionNavLinks.forEach((link, index) => {
            const id = link.dataset.section;
            if (!id) return;
            const heading = document.getElementById(id);
            if (!heading) return;
            const section = heading.closest('section') || heading;
            section.dataset.sectionId = id;
            if (observer) {
              observer.observe(section);
            }
            link.addEventListener('click', (event) => {
              event.preventDefault();
              heading.scrollIntoView({ behavior: 'smooth', block: 'start' });
              setActiveLink(link);
              if (heading instanceof HTMLElement) {
                heading.setAttribute('tabindex', '-1');
                heading.focus({ preventScroll: true });
                heading.addEventListener(
                  'blur',
                  () => {
                    heading.removeAttribute('tabindex');
                  },
                  { once: true }
                );
              }
            });
            if (index === 0) {
              defaultLink = link;
            }
          });

          if (defaultLink) {
            setActiveLink(defaultLink);
          }
        }

        const choicesInstances = new Map();
        if (window.Choices) {
          document.querySelectorAll('select[data-choices="true"]').forEach((select) => {
            const instance = new Choices(select, {
              shouldSort: false,
              allowHTML: false,
              itemSelectText: '',
              searchPlaceholderValue: 'Buscar...',
              placeholder: true,
              placeholderValue: 'Selecione',
            });
            choicesInstances.set(select.id, instance);
          });
        }

        const resetSelect = (element) => {
          if (!element) return;
          const instance = choicesInstances.get(element.id);
          if (instance) {
            instance.removeActiveItems();
            try {
              instance.setChoiceByValue('');
            } catch (error) {
              /* noop */
            }
          } else {
            element.value = '';
          }
        };

        const clearGroupInputs = (group) => {
          if (!group) return;
          const inputs = group.querySelectorAll('input, select, textarea');
          inputs.forEach((input) => {
            if (input.type === 'radio' || input.type === 'checkbox') {
              input.checked = false;
            } else if (input.tagName === 'SELECT') {
              resetSelect(input);
            } else {
              input.value = '';
            }
          });
        };

        const toggleGroup = (group, show) => {
          if (!group) return;
          group.classList.toggle('d-none', !show);
          if (!show) {
            clearGroupInputs(group);
          }
        };

        const getCheckedValue = (name) => {
          const selected = document.querySelector(`input[name="${name}"]:checked`);
          return selected ? selected.value : null;
        };

        const deficienciaQualGroup = document.getElementById('deficienciaQualGroup');
        const deficienciaRadios = document.querySelectorAll('input[name="deficienciaSindrome"]');
        const deficienciaViolenciaRadios = document.querySelectorAll('input[name="deficienciaViolencia"]');
        const updateDeficiencia = () => {
          const valor = getCheckedValue('deficienciaSindrome');
          const mostrarQual = valor === 'Sim';
          toggleGroup(deficienciaQualGroup, mostrarQual);
          deficienciaViolenciaRadios.forEach((radio) => {
            const habilitar = valor === 'Sim';
            radio.disabled = !habilitar;
            if (!habilitar) {
              radio.checked = false;
            }
          });
        };
        deficienciaRadios.forEach((radio) => radio.addEventListener('change', updateDeficiencia));

        const problemaSaudeQualGroup = document.getElementById('problemaSaudeQualGroup');
        const problemaSaudeRadios = document.querySelectorAll('input[name="problemaSaude"]');
        const updateProblemaSaude = () => {
          toggleGroup(problemaSaudeQualGroup, getCheckedValue('problemaSaude') === 'Sim');
        };
        problemaSaudeRadios.forEach((radio) => radio.addEventListener('change', updateProblemaSaude));

        const tempoPsicologoGroup = document.getElementById('tempoPsicologoGroup');
        const psicologoRadios = document.querySelectorAll('input[name="atendimentoPsicologo"]');
        const updatePsicologo = () => {
          toggleGroup(tempoPsicologoGroup, getCheckedValue('atendimentoPsicologo') === 'Sim');
        };
        psicologoRadios.forEach((radio) => radio.addEventListener('change', updatePsicologo));

        const tempoPsiquiatraGroup = document.getElementById('tempoPsiquiatraGroup');
        const psiquiatraRadios = document.querySelectorAll('input[name="atendimentoPsiquiatra"]');
        const updatePsiquiatra = () => {
          toggleGroup(tempoPsiquiatraGroup, getCheckedValue('atendimentoPsiquiatra') === 'Sim');
        };
        psiquiatraRadios.forEach((radio) => radio.addEventListener('change', updatePsiquiatra));

        const medicamentosQuaisGroup = document.getElementById('medicamentosQuaisGroup');
        const medicamentosRadios = document.querySelectorAll('input[name="usoMedicamento"]');
        const updateMedicamentos = () => {
          toggleGroup(medicamentosQuaisGroup, getCheckedValue('usoMedicamento') === 'Sim');
        };
        medicamentosRadios.forEach((radio) => radio.addEventListener('change', updateMedicamentos));

        const drogasLicitasGroup = document.getElementById('drogasLicitasGroup');
        const drogasLicitasRadios = document.querySelectorAll('input[name="usoDrogasLicitas"]');
        const drogasLicitasOutrasGroup = document.getElementById('drogasLicitasOutrasGroup');
        const drogaLicitaOutrasCheckbox = document.getElementById('drogaLicitaOutras');
        const updateDrogasLicitas = () => {
          const mostrar = getCheckedValue('usoDrogasLicitas') === 'Sim';
          toggleGroup(drogasLicitasGroup, mostrar);
          if (!mostrar) {
            toggleGroup(drogasLicitasOutrasGroup, false);
          }
        };
        drogasLicitasRadios.forEach((radio) => radio.addEventListener('change', updateDrogasLicitas));
        if (drogaLicitaOutrasCheckbox) {
          drogaLicitaOutrasCheckbox.addEventListener('change', () => {
            toggleGroup(drogasLicitasOutrasGroup, drogaLicitaOutrasCheckbox.checked);
          });
        }

        const drogasIlicitasGroup = document.getElementById('drogasIlicitasGroup');
        const drogasIlicitasRadios = document.querySelectorAll('input[name="usoDrogasIlicitas"]');
        const drogasIlicitasOutrasGroup = document.getElementById('drogasIlicitasOutrasGroup');
        const drogaIlicitaOutrasCheckbox = document.getElementById('drogaIlicitaOutras');
        const updateDrogasIlicitas = () => {
          const mostrar = getCheckedValue('usoDrogasIlicitas') === 'Sim';
          toggleGroup(drogasIlicitasGroup, mostrar);
          if (!mostrar) {
            toggleGroup(drogasIlicitasOutrasGroup, false);
          }
        };
        drogasIlicitasRadios.forEach((radio) => radio.addEventListener('change', updateDrogasIlicitas));
        if (drogaIlicitaOutrasCheckbox) {
          drogaIlicitaOutrasCheckbox.addEventListener('change', () => {
            toggleGroup(drogasIlicitasOutrasGroup, drogaIlicitaOutrasCheckbox.checked);
          });
        }

        const tempoGestacaoGroup = document.getElementById('tempoGestacaoGroup');
        const gestanteRadios = document.querySelectorAll('input[name="gestante"]');
        const updateGestante = () => {
          toggleGroup(tempoGestacaoGroup, getCheckedValue('gestante') === 'Sim');
        };
        gestanteRadios.forEach((radio) => radio.addEventListener('change', updateGestante));

        const identidadeGeneroSelect = document.getElementById('identidadeGenero');
        const preventivoGroup = document.getElementById('preventivoGroup');
        const preventivoAnoGroup = document.getElementById('preventivoAnoGroup');
        const preventivoRadios = document.querySelectorAll('input[name="preventivoColo"]');
        const mamografiaGroup = document.getElementById('mamografiaGroup');
        const mamografiaAnoGroup = document.getElementById('mamografiaAnoGroup');
        const mamografiaRadios = document.querySelectorAll('input[name="mamografia"]');
        const isPerfilFeminino = () => {
          if (!identidadeGeneroSelect) return false;
          const valor = identidadeGeneroSelect.value;
          return ['Mulher cisg√™nero', 'Mulher trans', 'Travesti'].includes(valor);
        };
        const atualizarExamesFemininos = () => {
          const feminino = isPerfilFeminino();
          toggleGroup(preventivoGroup, feminino);
          toggleGroup(mamografiaGroup, feminino);
          if (!feminino) {
            toggleGroup(preventivoAnoGroup, false);
            toggleGroup(mamografiaAnoGroup, false);
          }
        };
        const updatePreventivoAno = () => {
          toggleGroup(preventivoAnoGroup, getCheckedValue('preventivoColo') === 'Sim');
        };
        const updateMamografiaAno = () => {
          toggleGroup(mamografiaAnoGroup, getCheckedValue('mamografia') === 'Sim');
        };
        preventivoRadios.forEach((radio) => radio.addEventListener('change', updatePreventivoAno));
        mamografiaRadios.forEach((radio) => radio.addEventListener('change', updateMamografiaAno));
        if (identidadeGeneroSelect) {
          identidadeGeneroSelect.addEventListener('change', atualizarExamesFemininos);
        }

        const resultadoHivGroup = document.getElementById('resultadoHivGroup');
        const exameHivRadios = document.querySelectorAll('input[name="exameHiv"]');
        const contraiuAgressorGroup = document.getElementById('contraiuAgressorGroup');
        const resultadoHivRadios = document.querySelectorAll('input[name="resultadoHiv"]');
        const updateResultadoHiv = () => {
          const mostrar = getCheckedValue('exameHiv') === 'Sim';
          toggleGroup(resultadoHivGroup, mostrar);
          if (!mostrar) {
            toggleGroup(contraiuAgressorGroup, false);
          }
        };
        const updateContraiuAgressor = () => {
          toggleGroup(contraiuAgressorGroup, getCheckedValue('resultadoHiv') === 'Positivo');
        };
        exameHivRadios.forEach((radio) => radio.addEventListener('change', updateResultadoHiv));
        resultadoHivRadios.forEach((radio) => radio.addEventListener('change', updateContraiuAgressor));

        const tempoAcompanhamentoGroup = document.getElementById('tempoAcompanhamentoGroup');
        const acompanhamentoRadios = document.querySelectorAll('input[name="acompanhamentoSaudeContinuo"]');
        const updateAcompanhamento = () => {
          toggleGroup(tempoAcompanhamentoGroup, getCheckedValue('acompanhamentoSaudeContinuo') === 'Sim');
        };
        acompanhamentoRadios.forEach((radio) => radio.addEventListener('change', updateAcompanhamento));

        updateDeficiencia();
        updateProblemaSaude();
        updatePsicologo();
        updatePsiquiatra();
        updateMedicamentos();
        updateDrogasLicitas();
        if (drogaLicitaOutrasCheckbox) {
          toggleGroup(
            drogasLicitasOutrasGroup,
            getCheckedValue('usoDrogasLicitas') === 'Sim' && drogaLicitaOutrasCheckbox.checked
          );
        }
        updateDrogasIlicitas();
        if (drogaIlicitaOutrasCheckbox) {
          toggleGroup(
            drogasIlicitasOutrasGroup,
            getCheckedValue('usoDrogasIlicitas') === 'Sim' && drogaIlicitaOutrasCheckbox.checked
          );
        }
        updateGestante();
        if (identidadeGeneroSelect) {
          atualizarExamesFemininos();
        }
        updatePreventivoAno();
        updateMamografiaAno();
        updateResultadoHiv();
        updateContraiuAgressor();
        updateAcompanhamento();

        const estados = ['AC', 'AL', 'AP', 'AM', 'BA', 'CE', 'DF', 'ES', 'GO', 'MA', 'MT', 'MS', 'MG', 'PA', 'PB', 'PR', 'PE', 'PI', 'RJ', 'RN', 'RS', 'RO', 'RR', 'SC', 'SP', 'SE', 'TO'];
        const citiesByState = {
          PE: ['Recife', 'Olinda', 'Caruaru', 'Jaboat√£o dos Guararapes', 'Petrolina'],
          PB: ['Jo√£o Pessoa', 'Campina Grande', 'Patos', 'Sousa'],
          AL: ['Macei√≥', 'Arapiraca', 'Palmeira dos √çndios'],
          CE: ['Fortaleza', 'Juazeiro do Norte', 'Sobral'],
          BA: ['Salvador', 'Feira de Santana', 'Vit√≥ria da Conquista'],
          SP: ['S√£o Paulo', 'Campinas', 'Santos'],
          RJ: ['Rio de Janeiro', 'Niter√≥i', 'Campos dos Goytacazes'],
        };

        const ufSelects = ['uf', 'ufNascimento', 'ufExpedicao']
          .map((id) => document.getElementById(id))
          .filter(Boolean);
        ufSelects.forEach((select) => {
          estados.forEach((estado) => {
            const option = document.createElement('option');
            option.value = estado;
            option.textContent = estado;
            select.appendChild(option);
          });
        });

        const cidadeNascimentoSelect = document.getElementById('cidadeNascimento');
        const ufNascimentoSelect = document.getElementById('ufNascimento');
        if (ufNascimentoSelect && cidadeNascimentoSelect) {
          ufNascimentoSelect.addEventListener('change', (event) => {
            const ufSelecionada = event.target.value;
            cidadeNascimentoSelect.innerHTML = '';
            const placeholder = document.createElement('option');
            placeholder.value = '';
            placeholder.textContent = ufSelecionada ? 'Selecione' : 'Selecione a UF primeiro';
            cidadeNascimentoSelect.appendChild(placeholder);
            if (citiesByState[ufSelecionada]) {
              citiesByState[ufSelecionada].forEach((cidade) => {
                const option = document.createElement('option');
                option.value = cidade;
                option.textContent = cidade;
                cidadeNascimentoSelect.appendChild(option);
              });
            }
          });
        }

        const dataNascimentoInput = document.getElementById('dataNascimento');
        const idadeInput = document.getElementById('idade');
        const calcularIdade = () => {
          if (!dataNascimentoInput || !idadeInput) return;
          const valor = dataNascimentoInput.value.trim();
          if (!valor || valor.length < 8) {
            idadeInput.value = '';
            return;
          }
          const partes = valor.split('/');
          if (partes.length !== 3) {
            idadeInput.value = '';
            return;
          }
          const [dia, mes, ano] = partes;
          const iso = `${ano}-${mes}-${dia}`;
          const dataNasc = dayjs(iso);
          if (!dataNasc.isValid()) {
            idadeInput.value = '';
            return;
          }
          const idade = dayjs().diff(dataNasc, 'year');
          idadeInput.value = Number.isFinite(idade) ? `${idade} anos` : '';
        };
        if (dataNascimentoInput) {
          dataNascimentoInput.addEventListener('input', calcularIdade);
          dataNascimentoInput.addEventListener('change', calcularIdade);
          dataNascimentoInput.addEventListener('blur', calcularIdade);
        }

        const cepInput = document.getElementById('cep');
        const logradouroInput = document.getElementById('logradouro');
        const bairroInput = document.getElementById('bairro');
        const cidadeInput = document.getElementById('cidade');
        const ufInput = document.getElementById('uf');
        const cepHelp = document.getElementById('cepHelp');
        const limparEndereco = () => {
          if (logradouroInput) logradouroInput.value = '';
          if (bairroInput) bairroInput.value = '';
          if (cidadeInput) cidadeInput.value = '';
          if (ufInput) ufInput.value = '';
        };
        if (cepInput) {
          cepInput.addEventListener('blur', async () => {
            const cepNumeros = cepInput.value.replace(/\D/g, '');
            if (cepNumeros.length !== 8) {
              if (cepHelp) {
                cepHelp.textContent = 'Digite um CEP v√°lido com 8 d√≠gitos.';
              }
              limparEndereco();
              return;
            }
            if (cepHelp) {
              cepHelp.textContent = 'Consultando CEP na Brasil API...';
            }
            try {
              const response = await fetch(`https://brasilapi.com.br/api/cep/v1/${cepNumeros}`);
              if (!response.ok) {
                throw new Error('CEP n√£o encontrado');
              }
              const data = await response.json();
              if (logradouroInput) logradouroInput.value = data.street || '';
              if (bairroInput) bairroInput.value = data.neighborhood || '';
              if (cidadeInput) cidadeInput.value = data.city || '';
              if (ufInput) ufInput.value = data.state || '';
              if (cepHelp) {
                cepHelp.textContent = '';
              }
            } catch (error) {
              limparEndereco();
              if (cepHelp) {
                cepHelp.textContent = 'N√£o foi poss√≠vel localizar o CEP. Preencha os dados manualmente.';
              }
            }
          });
        }

        const atendimentoChecks = document.querySelectorAll('.atendimento-check');
        const encaminhamentosAlert = document.getElementById('encaminhamentosAlert');
        const atualizarEncaminhamentos = () => {
          if (!encaminhamentosAlert) return;
          const deveExibir = Array.from(atendimentoChecks).some((check) =>
            check.checked && (check.value === 'Acolhida/Orienta√ß√£o' || check.value === 'Outros Munic√≠pios')
          );
          encaminhamentosAlert.classList.toggle('d-none', !deveExibir);
        };
        atendimentoChecks.forEach((check) => {
          check.addEventListener('change', atualizarEncaminhamentos);
        });

        const escolaridadeSelect = document.getElementById('escolaridade');
        const situacaoOcupacionalSelect = document.getElementById('situacaoOcupacional');
        const detalhesTrabalho = document.getElementById('detalhesTrabalho');
        const situacaoTrabalhoSelect = document.getElementById('situacaoTrabalho');
        const situacaoEscolarGroup = document.getElementById('situacaoEscolarGroup');
        const cursoFormacaoGroup = document.getElementById('cursoFormacaoGroup');
        const tipoPosGraduacaoGroup = document.getElementById('tipoPosGraduacaoGroup');
        const anoPeriodoGroup = document.getElementById('anoPeriodoGroup');
        const situacaoEscolarSelect = document.getElementById('situacaoEscolar');
        const cursoFormacaoInput = document.getElementById('cursoFormacao');
        const tipoPosGraduacaoSelect = document.getElementById('tipoPosGraduacao');
        const anoPeriodoInput = document.getElementById('anoPeriodo');

        const atualizarDetalhesEscolares = () => {
          if (!escolaridadeSelect) return;
          const valor = escolaridadeSelect.value;
          const mostrarSituacao = valor && valor !== 'Sem instru√ß√£o';
          if (situacaoEscolarGroup) {
            situacaoEscolarGroup.classList.toggle('d-none', !mostrarSituacao);
          }
          if (!mostrarSituacao && situacaoEscolarSelect) {
            situacaoEscolarSelect.value = '';
          }
          const cursosQueExigemDetalhe = [
            'Curso t√©cnico',
            'Tecn√≥logo',
            'Ensino superior',
            'P√≥s-gradua√ß√£o',
            'Mestrado',
            'Doutorado',
          ];
          const mostrarCurso = cursosQueExigemDetalhe.includes(valor);
          if (cursoFormacaoGroup) {
            cursoFormacaoGroup.classList.toggle('d-none', !mostrarCurso);
          }
          if (!mostrarCurso && cursoFormacaoInput) {
            cursoFormacaoInput.value = '';
          }
          const mostrarPosGraduacao = valor === 'P√≥s-gradua√ß√£o';
          if (tipoPosGraduacaoGroup) {
            tipoPosGraduacaoGroup.classList.toggle('d-none', !mostrarPosGraduacao);
          }
          if (!mostrarPosGraduacao && tipoPosGraduacaoSelect) {
            tipoPosGraduacaoSelect.value = '';
          }
          const mostrarAnoPeriodo = valor && valor !== 'Sem instru√ß√£o';
          if (anoPeriodoGroup) {
            anoPeriodoGroup.classList.toggle('d-none', !mostrarAnoPeriodo);
          }
          if (!mostrarAnoPeriodo && anoPeriodoInput) {
            anoPeriodoInput.value = '';
          }
        };

        const atualizarDetalhesTrabalho = () => {
          const mostrarTrabalho =
            (situacaoOcupacionalSelect && situacaoOcupacionalSelect.value !== '') ||
            (situacaoTrabalhoSelect && situacaoTrabalhoSelect.value !== '');
          if (detalhesTrabalho) {
            detalhesTrabalho.classList.toggle('d-none', !mostrarTrabalho);
          }
        };

        const atualizarDetalhes = () => {
          atualizarDetalhesEscolares();
          atualizarDetalhesTrabalho();
        };

        if (escolaridadeSelect) {
          escolaridadeSelect.addEventListener('change', atualizarDetalhes);
        }
        if (situacaoOcupacionalSelect) {
          situacaoOcupacionalSelect.addEventListener('change', atualizarDetalhes);
        }
        if (situacaoTrabalhoSelect) {
          situacaoTrabalhoSelect.addEventListener('change', atualizarDetalhes);
        }
        atualizarDetalhes();

        const situacaoHabitacionalSelect = document.getElementById('situacaoHabitacional');
        const situacaoHabitacionalOutroGroup = document.getElementById('situacaoHabitacionalOutroGroup');
        const situacaoHabitacionalOutroInput = document.getElementById('situacaoHabitacionalOutro');
        const atualizarSituacaoHabitacionalOutro = () => {
          if (!situacaoHabitacionalSelect || !situacaoHabitacionalOutroGroup) return;
          const mostrarOutro = situacaoHabitacionalSelect.value === 'Outros';
          situacaoHabitacionalOutroGroup.classList.toggle('d-none', !mostrarOutro);
          if (!mostrarOutro && situacaoHabitacionalOutroInput) {
            situacaoHabitacionalOutroInput.value = '';
          }
        };
        if (situacaoHabitacionalSelect) {
          situacaoHabitacionalSelect.addEventListener('change', atualizarSituacaoHabitacionalOutro);
          atualizarSituacaoHabitacionalOutro();
        }

        const cursosWrapper = document.getElementById('cursosWrapper');
        const adicionarCursoBtn = document.getElementById('adicionarCurso');
        const cursosExtras = document.getElementById('cursosExtras');
        const cursoCapacitacao = document.getElementById('cursoCapacitacao');
        let cursosAdicionados = 1;
        const atualizarWrapperCursos = (mostrar) => {
          if (!cursosWrapper) return;
          cursosWrapper.classList.toggle('d-none', !mostrar);
          if (!mostrar) {
            cursosAdicionados = 1;
            if (cursoCapacitacao) {
              cursoCapacitacao.value = '';
            }
            if (cursosExtras) {
              cursosExtras.innerHTML = '';
            }
            if (adicionarCursoBtn) {
              adicionarCursoBtn.disabled = false;
            }
          }
        };
        const interesseRadios = document.querySelectorAll('input[name="interesseCapacitacao"]');
        interesseRadios.forEach((radio) => {
          radio.addEventListener('change', () => {
            atualizarWrapperCursos(radio.value === 'Sim');
          });
        });
        if (adicionarCursoBtn && cursosExtras) {
          adicionarCursoBtn.addEventListener('click', () => {
            if (cursosAdicionados >= 3) {
              adicionarCursoBtn.disabled = true;
              return;
            }
            cursosAdicionados += 1;
            const novoInput = document.createElement('input');
            novoInput.type = 'text';
            novoInput.className = 'form-control';
            novoInput.name = 'cursos[]';
            novoInput.placeholder = `Outro curso (${cursosAdicionados}¬∫)`;
            cursosExtras.appendChild(novoInput);
            if (cursosAdicionados >= 3) {
              adicionarCursoBtn.disabled = true;
            }
          });
        }

        const familiaTabelaBody = document.getElementById('familiaTabelaBody');
        const familiaHiddenInputs = document.getElementById('familiaHiddenInputs');
        const familiaModalElement = document.getElementById('familiaModal');
        const familiaModalForm = document.getElementById('familiaModalForm');
        const adicionarMembroFamiliaBtn = document.getElementById('adicionarMembroFamilia');
        let familiaModalInstance = null;

        const ensureFamiliaModal = () => {
          if (!familiaModalElement || typeof bootstrap === 'undefined' || !bootstrap.Modal) {
            return null;
          }
          familiaModalInstance = bootstrap.Modal.getOrCreateInstance(familiaModalElement);
          return familiaModalInstance;
        };

        if (adicionarMembroFamiliaBtn) {
          adicionarMembroFamiliaBtn.addEventListener('click', (event) => {
            event.preventDefault();
            const modal = ensureFamiliaModal();
            if (modal) {
              modal.show();
            }
          });
        }

        const restaurarTabelaFamilia = () => {
          if (familiaTabelaBody) {
            familiaTabelaBody.innerHTML = '';
            const vazio = document.createElement('tr');
            vazio.id = 'familiaVazia';
            const celula = document.createElement('td');
            celula.colSpan = 4;
            celula.className = 'text-center text-muted';
            celula.textContent = 'Nenhum membro informado.';
            vazio.appendChild(celula);
            familiaTabelaBody.appendChild(vazio);
          }
          if (familiaHiddenInputs) {
            familiaHiddenInputs.innerHTML = '';
          }
        };

        if (familiaModalElement && familiaModalForm) {
          familiaModalElement.addEventListener('hidden.bs.modal', () => {
            familiaModalForm.reset();
          });

          familiaModalForm.addEventListener('submit', (event) => {
            event.preventDefault();
            if (!familiaModalForm.checkValidity()) {
              familiaModalForm.reportValidity();
              return;
            }

            const formData = new FormData(familiaModalForm);
            const dados = {
              nome: (formData.get('familiaNome') || '').toString().trim(),
              parentesco: (formData.get('familiaParentesco') || '').toString(),
              idadeAnos: (formData.get('familiaIdadeAnos') || '').toString(),
              idadeMeses: (formData.get('familiaIdadeMeses') || '').toString(),
              escolaridade: (formData.get('familiaEscolaridade') || '').toString(),
              redeEnsino: (formData.get('familiaRedeEnsino') || '').toString(),
              profissao: (formData.get('familiaProfissao') || '').toString(),
              deficienciaMotora: (formData.get('familiaDeficienciaMotora') || 'N√£o').toString(),
              deficienciaAuditiva: (formData.get('familiaDeficienciaAuditiva') || 'N√£o').toString(),
              deficienciaVisual: (formData.get('familiaDeficienciaVisual') || 'N√£o').toString(),
              deficienciaMental: (formData.get('familiaDeficienciaMental') || 'N√£o').toString(),
              beneficio: (formData.get('familiaBeneficio') || '').toString(),
              bpc: (formData.get('familiaBpc') || 'N√£o').toString(),
            };

            if (familiaTabelaBody) {
              const vazio = document.getElementById('familiaVazia');
              if (vazio) {
                vazio.remove();
              }
              const linha = document.createElement('tr');
              const criarCelula = (valor) => {
                const cel = document.createElement('td');
                cel.textContent = valor;
                return cel;
              };
              linha.appendChild(criarCelula(dados.nome));
              linha.appendChild(criarCelula(dados.parentesco));
              linha.appendChild(criarCelula(dados.idadeAnos));
              linha.appendChild(criarCelula(dados.idadeMeses || '0'));
              familiaTabelaBody.appendChild(linha);
            }

            if (familiaHiddenInputs) {
              const wrapper = document.createElement('div');
              wrapper.className = 'familia-hidden-set';
              const adicionarHidden = (chave, valor) => {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = `familia[${chave}][]`;
                input.value = valor || '';
                wrapper.appendChild(input);
              };
              adicionarHidden('nome', dados.nome);
              adicionarHidden('parentesco', dados.parentesco);
              adicionarHidden('idadeAnos', dados.idadeAnos);
              adicionarHidden('idadeMeses', dados.idadeMeses || '0');
              adicionarHidden('escolaridade', dados.escolaridade);
              adicionarHidden('redeEnsino', dados.redeEnsino);
              adicionarHidden('profissao', dados.profissao);
              adicionarHidden('deficienciaMotora', dados.deficienciaMotora);
              adicionarHidden('deficienciaAuditiva', dados.deficienciaAuditiva);
              adicionarHidden('deficienciaVisual', dados.deficienciaVisual);
              adicionarHidden('deficienciaMental', dados.deficienciaMental);
              adicionarHidden('beneficio', dados.beneficio);
              adicionarHidden('bpc', dados.bpc);
              familiaHiddenInputs.appendChild(wrapper);
            }

            const modalInstance = ensureFamiliaModal();
            if (modalInstance) {
              modalInstance.hide();
            }
            familiaModalForm.reset();
          });
        }

        const numeroProntuarioInput = document.getElementById('numeroProntuario');
        const dataAtendimentoInput = document.getElementById('dataAtendimento');
        const horaAtendimentoInput = document.getElementById('horaAtendimento');
        const setCurrentDateTime = () => {
          if (!dataAtendimentoInput && !horaAtendimentoInput) return;
          const agora = new Date();
          const pad = (num) => String(num).padStart(2, '0');
          const dataValor = `${pad(agora.getDate())}/${pad(agora.getMonth() + 1)}/${agora.getFullYear()}`;
          const horaValor = `${pad(agora.getHours())}:${pad(agora.getMinutes())}`;
          if (numeroProntuarioInput) {
            const dataStamp = `${agora.getFullYear()}${pad(agora.getMonth() + 1)}${pad(agora.getDate())}`;
            const horaStamp = `${pad(agora.getHours())}${pad(agora.getMinutes())}`;
            numeroProntuarioInput.value = `PR-${dataStamp}-${horaStamp}`;
          }
          if (dataAtendimentoInput) {
            dataAtendimentoInput.value = dataValor;
          }
          if (horaAtendimentoInput) {
            horaAtendimentoInput.value = horaValor;
          }
        };

        const tabFormTrigger = document.getElementById('form-tab');
        if (tabFormTrigger) {
          tabFormTrigger.addEventListener('shown.bs.tab', setCurrentDateTime);
        }

        if (window.Chart) {
          const ctxPie = document.getElementById('chartViolenceTypes');
          if (ctxPie) {
            new Chart(ctxPie, {
              type: 'pie',
              data: {
                labels: ['Psicol√≥gica', 'F√≠sica', 'Sexual', 'Moral', 'Patrimonial'],
                datasets: [
                  {
                    data: [38, 26, 14, 12, 10],
                    backgroundColor: ['#6f42c1', '#d63384', '#fd7e14', '#198754', '#0dcaf0'],
                    borderWidth: 0,
                  },
                ],
              },
              options: {
                plugins: {
                  legend: { display: false },
                  tooltip: {
                    callbacks: {
                      label: (context) => `${context.label}: ${context.parsed}%`,
                    },
                  },
                },
              },
            });
          }

          const ctxBar = document.getElementById('chartReferrals');
          if (ctxBar) {
            new Chart(ctxBar, {
              type: 'bar',
              data: {
                labels: ['Delegacia da Mulher', 'Sa√∫de', 'CREAS', 'Defensoria', 'Judici√°rio'],
                datasets: [
                  {
                    label: 'Encaminhamentos',
                    data: [42, 35, 28, 22, 18],
                    backgroundColor: '#0053a4',
                    borderRadius: 8,
                  },
                ],
              },
              options: {
                plugins: {
                  legend: { display: false },
                },
                scales: {
                  y: {
                    beginAtZero: true,
                    ticks: {
                      stepSize: 10,
                    },
                  },
                },
              },
            });
          }
        }

        const maskConfig = [
          { selector: '#cpfUsuario', mask: '000.000.000-00' },
          { selector: '#cep', mask: '00000-000' },
          { selector: '#telefone', mask: '(00) 00000-0000' },
          { selector: '#telefoneSecundario', mask: '(00) 00000-0000' },
          { selector: '#dataAtendimento', mask: '00/00/0000' },
          { selector: '#horaAtendimento', mask: '00:00' },
          { selector: '#dataNascimento', mask: '00/00/0000' },
          { selector: '#dataOcorrencia', mask: '00/00/0000' },
        ];

        maskConfig.forEach(({ selector, mask }) => {
          const element = document.querySelector(selector);
          if (element && window.IMask) {
            IMask(element, { mask });
          }
        });

        const rendaField = document.getElementById('rendaIndividual');
        if (rendaField && window.IMask) {
          IMask(rendaField, {
            mask: Number,
            scale: 2,
            thousandsSeparator: '.',
            padFractionalZeros: true,
            radix: ',',
            mapToRadix: ['.'],
            min: 0,
          });
        }

        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.forEach((tooltipTriggerEl) => {
          new bootstrap.Tooltip(tooltipTriggerEl);
        });

        if (window.JustValidate) {
          const validator = new JustValidate('#registroForm', {
            errorFieldCssClass: 'is-invalid',
            focusInvalidField: true,
            lockForm: true,
            tooltip: {
              position: 'top',
            },
          });

          validator
            .addField('#numeroProntuario', [{ rule: 'required', errorMessage: 'Informe o n√∫mero do prontu√°rio.' }])
            .addField('#numeroSus', [{ rule: 'required', errorMessage: 'Informe o n√∫mero do Cart√£o SUS.' }])
            .addField('#unidadeAtendimento', [{ rule: 'required', errorMessage: 'Selecione a unidade.' }])
            .addField('#dataAtendimento', [{ rule: 'required', errorMessage: 'Informe a data do atendimento.' }])
            .addField('#horaAtendimento', [{ rule: 'required', errorMessage: 'Informe a hora do atendimento.' }])
            .addField('#nomeUsuario', [{ rule: 'required', errorMessage: 'Informe o nome completo.' }])
            .addField('#cpfUsuario', [{ rule: 'required', errorMessage: 'Informe o CPF.' }])
            .addField('#dataNascimento', [{ rule: 'required', errorMessage: 'Informe a data de nascimento.' }])
            .addField('#cep', [{ rule: 'required', errorMessage: 'Informe o CEP.' }])
            .addField('#logradouro', [{ rule: 'required', errorMessage: 'Informe o logradouro.' }])
            .addField('#bairro', [{ rule: 'required', errorMessage: 'Informe o bairro.' }])
            .addField('#cidade', [{ rule: 'required', errorMessage: 'Informe a cidade.' }])
            .addField('#uf', [{ rule: 'required', errorMessage: 'Informe a UF.' }])
            .addRequiredGroup('input[name="deficienciaSindrome"]', 'Informe se h√° defici√™ncia ou s√≠ndrome.')
            .addField('#deficienciaQual', [
              {
                rule: 'function',
                errorMessage: 'Selecione a defici√™ncia.',
                validator: () => {
                  if (getCheckedValue('deficienciaSindrome') !== 'Sim') return true;
                  const select = document.getElementById('deficienciaQual');
                  return select ? select.value.trim().length > 0 : true;
                },
              },
            ])
            .addField('#deficienciaViolenciaSim', [
              {
                rule: 'function',
                errorMessage: 'Informe se a defici√™ncia decorre da viol√™ncia.',
                validator: () => {
                  if (getCheckedValue('deficienciaSindrome') !== 'Sim') return true;
                  return document.querySelector('input[name="deficienciaViolencia"]:checked') !== null;
                },
              },
            ])
            .addRequiredGroup('input[name="problemaSaude"]', 'Informe se apresenta problema de sa√∫de.')
            .addField('#problemaSaudeQual', [
              {
                rule: 'function',
                errorMessage: 'Descreva o problema de sa√∫de.',
                validator: () => {
                  if (getCheckedValue('problemaSaude') !== 'Sim') return true;
                  const input = document.getElementById('problemaSaudeQual');
                  return input ? input.value.trim().length > 0 : true;
                },
              },
            ])
            .addRequiredGroup('input[name="atendimentoPsicologo"]', 'Informe se houve atendimento psicol√≥gico.')
            .addField('#tempoPsicologo', [
              {
                rule: 'function',
                errorMessage: 'Detalhe o tempo de atendimento psicol√≥gico.',
                validator: () => {
                  if (getCheckedValue('atendimentoPsicologo') !== 'Sim') return true;
                  const input = document.getElementById('tempoPsicologo');
                  return input ? input.value.trim().length > 0 : true;
                },
              },
            ])
            .addRequiredGroup('input[name="atendimentoPsiquiatra"]', 'Informe se houve atendimento psiqui√°trico.')
            .addField('#tempoPsiquiatra', [
              {
                rule: 'function',
                errorMessage: 'Detalhe o tempo de atendimento psiqui√°trico.',
                validator: () => {
                  if (getCheckedValue('atendimentoPsiquiatra') !== 'Sim') return true;
                  const input = document.getElementById('tempoPsiquiatra');
                  return input ? input.value.trim().length > 0 : true;
                },
              },
            ])
            .addRequiredGroup('input[name="usoMedicamento"]', 'Informe se faz uso de medicamentos.')
            .addField('#medicamentosQuais', [
              {
                rule: 'function',
                errorMessage: 'Liste os medicamentos em uso.',
                validator: () => {
                  if (getCheckedValue('usoMedicamento') !== 'Sim') return true;
                  const input = document.getElementById('medicamentosQuais');
                  return input ? input.value.trim().length > 0 : true;
                },
              },
            ])
            .addRequiredGroup('input[name="usoDrogasLicitas"]', 'Informe o uso de drogas l√≠citas.')
            .addField('#drogaLicitaTabaco', [
              {
                rule: 'function',
                errorMessage: 'Selecione ao menos uma droga l√≠cita.',
                validator: () => {
                  if (getCheckedValue('usoDrogasLicitas') !== 'Sim') return true;
                  return (
                    Array.from(document.querySelectorAll('input[name="drogasLicitas[]"]:checked')).length > 0
                  );
                },
              },
            ])
            .addField('#drogasLicitasOutrasTexto', [
              {
                rule: 'function',
                errorMessage: 'Detalhe as outras drogas l√≠citas.',
                validator: () => {
                  if (!drogaLicitaOutrasCheckbox || !drogaLicitaOutrasCheckbox.checked) return true;
                  const input = document.getElementById('drogasLicitasOutrasTexto');
                  return input ? input.value.trim().length > 0 : true;
                },
              },
            ])
            .addRequiredGroup('input[name="usoDrogasIlicitas"]', 'Informe o uso de drogas il√≠citas.')
            .addField('#drogaIlicitaCocaina', [
              {
                rule: 'function',
                errorMessage: 'Selecione ao menos uma droga il√≠cita.',
                validator: () => {
                  if (getCheckedValue('usoDrogasIlicitas') !== 'Sim') return true;
                  return (
                    Array.from(document.querySelectorAll('input[name="drogasIlicitas[]"]:checked')).length > 0
                  );
                },
              },
            ])
            .addField('#drogasIlicitasOutrasTexto', [
              {
                rule: 'function',
                errorMessage: 'Detalhe as outras drogas il√≠citas.',
                validator: () => {
                  if (!drogaIlicitaOutrasCheckbox || !drogaIlicitaOutrasCheckbox.checked) return true;
                  const input = document.getElementById('drogasIlicitasOutrasTexto');
                  return input ? input.value.trim().length > 0 : true;
                },
              },
            ])
            .addRequiredGroup('input[name="gestante"]', 'Informe se est√° gestante.')
            .addField('#tempoGestacao', [
              {
                rule: 'function',
                errorMessage: 'Informe o tempo de gesta√ß√£o.',
                validator: () => {
                  if (getCheckedValue('gestante') !== 'Sim') return true;
                  const select = document.getElementById('tempoGestacao');
                  return select ? select.value.trim().length > 0 : true;
                },
              },
            ])
            .addRequiredGroup('input[name="abortoViolencia"]', 'Informe se houve aborto decorrente da viol√™ncia.')
            .addField('#preventivoColoSim', [
              {
                rule: 'function',
                errorMessage: 'Informe se realizou preventivo.',
                validator: () => {
                  if (!preventivoGroup || preventivoGroup.classList.contains('d-none')) return true;
                  return document.querySelector('input[name="preventivoColo"]:checked') !== null;
                },
              },
            ])
            .addField('#preventivoAno', [
              {
                rule: 'function',
                errorMessage: 'Informe o ano do preventivo.',
                validator: () => {
                  if (getCheckedValue('preventivoColo') !== 'Sim') return true;
                  const input = document.getElementById('preventivoAno');
                  return input ? input.value.trim().length > 0 : true;
                },
              },
            ])
            .addField('#mamografiaSim', [
              {
                rule: 'function',
                errorMessage: 'Informe se realizou mamografia.',
                validator: () => {
                  if (!mamografiaGroup || mamografiaGroup.classList.contains('d-none')) return true;
                  return document.querySelector('input[name="mamografia"]:checked') !== null;
                },
              },
            ])
            .addField('#mamografiaAno', [
              {
                rule: 'function',
                errorMessage: 'Informe o ano da mamografia.',
                validator: () => {
                  if (getCheckedValue('mamografia') !== 'Sim') return true;
                  const input = document.getElementById('mamografiaAno');
                  return input ? input.value.trim().length > 0 : true;
                },
              },
            ])
            .addRequiredGroup('input[name="exameHiv"]', 'Informe se realizou exame de HIV.')
            .addField('#resultadoHivNegativo', [
              {
                rule: 'function',
                errorMessage: 'Informe o resultado do exame de HIV.',
                validator: () => {
                  if (getCheckedValue('exameHiv') !== 'Sim') return true;
                  return document.querySelector('input[name="resultadoHiv"]:checked') !== null;
                },
              },
            ])
            .addField('#contraiuAgressorSim', [
              {
                rule: 'function',
                errorMessage: 'Informe se contraiu com o agressor.',
                validator: () => {
                  if (getCheckedValue('resultadoHiv') !== 'Positivo') return true;
                  return document.querySelector('input[name="contraiuAgressor"]:checked') !== null;
                },
              },
            ])
            .addRequiredGroup('input[name="acompanhamentoSaudeContinuo"]', 'Informe se faz acompanhamento.')
            .addField('#tempoAcompanhamento', [
              {
                rule: 'function',
                errorMessage: 'Informe h√° quanto tempo realiza o tratamento.',
                validator: () => {
                  if (getCheckedValue('acompanhamentoSaudeContinuo') !== 'Sim') return true;
                  const select = document.getElementById('tempoAcompanhamento');
                  return select ? select.value.trim().length > 0 : true;
                },
              },
            ])
            .addField('#escolaridade', [{ rule: 'required', errorMessage: 'Informe a escolaridade.' }])
            .addField('#tipoViolencia', [{ rule: 'required', errorMessage: 'Selecione o tipo de viol√™ncia.' }])
            .addField('#localViolencia', [{ rule: 'required', errorMessage: 'Informe o local da viol√™ncia.' }])
            .addField('#relacaoAutor', [{ rule: 'required', errorMessage: 'Informe a rela√ß√£o com o autor.' }])
            .addRequiredGroup('input[name="avaliacaoInicial"]', 'Selecione a avalia√ß√£o inicial.')
            .addField('#cursoFormacao', [
              {
                rule: 'function',
                errorMessage: 'Informe o curso.',
                validator: () => {
                  if (!cursoFormacaoGroup || cursoFormacaoGroup.classList.contains('d-none')) {
                    return true;
                  }
                  return cursoFormacaoInput ? cursoFormacaoInput.value.trim().length > 0 : true;
                },
              },
            ])
            .addField('#emailConfirmacao', [
              {
                rule: 'function',
                errorMessage: 'O e-mail deve coincidir.',
                validator: () => {
                  const emailField = document.getElementById('email');
                  const confirmField = document.getElementById('emailConfirmacao');
                  if (!emailField || !confirmField) return true;
                  if (!emailField.value && !confirmField.value) return true;
                  return emailField.value === confirmField.value;
                },
              },
            ])
            .addField('#situacaoHabitacionalOutro', [
              {
                rule: 'function',
                errorMessage: 'Detalhe a situa√ß√£o habitacional.',
                validator: () => {
                  const select = document.getElementById('situacaoHabitacional');
                  const outro = document.getElementById('situacaoHabitacionalOutro');
                  if (!select || !outro) return true;
                  if (select.value !== 'Outros') return true;
                  return outro.value.trim().length > 0;
                },
              },
            ])
            .addField('#cursoCapacitacao', [
              {
                rule: 'function',
                errorMessage: 'Informe ao menos um curso.',
                validator: () => {
                  if (!cursosWrapper || cursosWrapper.classList.contains('d-none')) {
                    return true;
                  }
                  return !!cursoCapacitacao && cursoCapacitacao.value.trim().length > 0;
                },
              },
            ])
            .onSuccess((event) => {
              event.preventDefault();
              const form = event.target;
              const formData = new FormData(form);
              const payload = {};
              formData.forEach((value, key) => {
                if (payload[key]) {
                  if (!Array.isArray(payload[key])) {
                    payload[key] = [payload[key]];
                  }
                  payload[key].push(value);
                } else {
                  payload[key] = value;
                }
              });

              console.log('Registro submetido:', JSON.stringify(payload, null, 2));

              const toastEl = document.getElementById('successToast');
              if (toastEl) {
                const toast = new bootstrap.Toast(toastEl);
                toast.show();
              }

              form.reset();
              const invalidEls = form.querySelectorAll('.is-invalid');
              invalidEls.forEach((el) => el.classList.remove('is-invalid'));
              atualizarWrapperCursos(false);
              atualizarDetalhes();
              atualizarEncaminhamentos();
              atualizarSituacaoHabitacionalOutro();
              restaurarTabelaFamilia();
              updateDeficiencia();
              updateProblemaSaude();
              updatePsicologo();
              updatePsiquiatra();
              updateMedicamentos();
              updateDrogasLicitas();
              updateDrogasIlicitas();
              updateGestante();
              if (identidadeGeneroSelect) {
                atualizarExamesFemininos();
              }
              updatePreventivoAno();
              updateMamografiaAno();
              updateResultadoHiv();
              updateContraiuAgressor();
              updateAcompanhamento();
              if (cidadeNascimentoSelect) {
                cidadeNascimentoSelect.innerHTML = '';
                const option = document.createElement('option');
                option.value = '';
                option.textContent = 'Selecione a UF primeiro';
                cidadeNascimentoSelect.appendChild(option);
              }
              setCurrentDateTime();
            });
        }

        const openFormBtn = document.getElementById('openFormBtn');
        if (openFormBtn) {
          openFormBtn.addEventListener('click', () => {
            setCurrentDateTime();
            const formTabTrigger = document.querySelector('#form-tab');
            if (formTabTrigger) {
              const tab = new bootstrap.Tab(formTabTrigger);
              tab.show();
              document.getElementById('registroForm').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          });
        }

        setCurrentDateTime();
      });
    </script>
  </body>
</html>
